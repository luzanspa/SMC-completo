<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMC - Sistema de Marcação de Consultas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #00A859 0%, #28a745 25%, #20c997 50%, #00C766 100%);
            min-height: 100vh;
            position: relative;
        }

        /* Efeito de partículas */
        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .floating-icons {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .medical-icon {
            position: absolute;
            color: rgba(255, 255, 255, 0.1);
            font-size: 24px;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* Container principal */
        .login-container {
            position: relative;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 20px;
        }

        .logo-section {
            text-align: center;
            margin-bottom: 36px;
        }

        .login-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 28px;
            padding: 48px 40px;
            width: 100%;
            max-width: 440px;
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            animation: slideUpBounce 1s ease-out;
            position: relative;
        }

        .login-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(40, 199, 151, 0.1), rgba(23, 162, 184, 0.1));
            border-radius: 28px;
            z-index: -1;
        }

        .card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 28px;
            padding: 48px 40px;
            width: 100%;
            max-width: 440px;
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            animation: slideUpBounce 1s ease-out;
            position: relative;
            transition: transform 0.3s ease;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(40, 199, 151, 0.1), rgba(23, 162, 184, 0.1));
            border-radius: 28px;
            z-index: -1;
        }

        @keyframes slideUpBounce {
            0% { opacity: 0; transform: translateY(60px) scale(0.8); }
            60% { opacity: 0.8; transform: translateY(-10px) scale(1.05); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        .sus-logo {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #00A859, #28a745, #20c997);
            border-radius: 24px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 12px 40px rgba(0, 168, 89, 0.4),
                0 0 0 4px rgba(255, 255, 255, 0.1);
            animation: logoGlow 3s ease-in-out infinite alternate;
            position: relative;
            overflow: hidden;
        }

        .sus-logo::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes logoGlow {
            from { box-shadow: 0 12px 40px rgba(0, 168, 89, 0.4), 0 0 0 4px rgba(255, 255, 255, 0.1); }
            to { box-shadow: 0 16px 50px rgba(0, 168, 89, 0.6), 0 0 0 6px rgba(255, 255, 255, 0.2); }
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .login-title {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #1a1a1a, #333);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            text-align: center;
        }

        .login-subtitle {
            color: #666;
            font-size: 16px;
            margin-bottom: 32px;
            line-height: 1.5;
            text-align: center;
        }

        .system-badge {
            background: linear-gradient(135deg, #00A859, #28a745);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 24px;
            box-shadow: 0 4px 12px rgba(0, 168, 89, 0.3);
        }

        .form-group {
            margin-bottom: 28px;
            position: relative;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 14px;
            transition: color 0.3s ease;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid #e8ecef;
            border-radius: 16px;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(145deg, #fafbfc, #f8f9fa);
            position: relative;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #00A859;
            background: white;
            transform: translateY(-3px);
            box-shadow: 
                0 12px 32px rgba(0, 168, 89, 0.15),
                0 0 0 4px rgba(0, 168, 89, 0.1);
        }

        .form-input:focus + .form-label {
            color: #00A859;
        }

        .form-input::placeholder {
            color: #aaa;
            transition: opacity 0.3s ease;
        }

        .form-input:focus::placeholder {
            opacity: 0.5;
        }

        .input-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            font-size: 18px;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .form-group:focus-within .input-icon {
            color: #00A859;
        }

        .login-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 36px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #666;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .remember-me:hover {
            color: #00A859;
        }

        .remember-me input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #00A859;
            cursor: pointer;
        }

        .forgot-password {
            color: #00A859;
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
        }

        .forgot-password::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -2px;
            left: 0;
            background: #00A859;
            transition: width 0.3s ease;
        }

        .forgot-password:hover::after {
            width: 100%;
        }

        .login-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #00A859, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .login-button:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 20px 40px rgba(0, 168, 89, 0.4),
                0 0 0 4px rgba(0, 168, 89, 0.1);
        }

        .login-button:active {
            transform: translateY(-2px);
        }

        .login-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .login-button:hover::before {
            left: 100%;
        }

        .footer-section {
            text-align: center;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid #eee;
        }

        .footer-text {
            color: #666;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .footer-link {
            color: #00A859;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .footer-link:hover {
            color: #007A41;
            text-decoration: underline;
        }

        .help-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 16px;
        }

        .help-link {
            color: #999;
            text-decoration: none;
            font-size: 12px;
            transition: color 0.3s ease;
        }

        .help-link:hover {
            color: #00A859;
        }

        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #00A859, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 20px 40px rgba(0, 168, 89, 0.4),
                0 0 0 4px rgba(0, 168, 89, 0.1);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        /* Painel Admin */
        #adminPanel {
            display: none;
            position: relative;
            z-index: 10;
            padding: 20px;
            min-height: 100vh;
        }

        .admin-header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 14px 24px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #00A859, #28a745);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 168, 89, 0.3);
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .users-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .users-table th,
        .users-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        .users-table th {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            font-weight: 600;
            color: #333;
        }

        .users-table tr:hover {
            background: rgba(0, 168, 89, 0.05);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
            margin: 0 4px;
            border-radius: 8px;
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
        }

        .hidden {
            display: none !important;
        }

        .input-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            font-size: 18px;
            transition: color 0.3s ease;
        }

        .form-group:focus-within .input-icon {
            color: #00A859;
        }

        /* Estados de loading */
        .loading .login-button {
            background: linear-gradient(135deg, #6c757d, #adb5bd);
            cursor: not-allowed;
        }

        .success .login-button {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .card {
                padding: 32px 24px;
                margin: 16px;
                border-radius: 20px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .users-table {
                font-size: 14px;
            }

            .admin-header {
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Estilos do Sistema de Marcação de Consultas */
        #consultasPanel {
            display: none;
            position: relative;
            z-index: 10;
            padding: 20px;
            min-height: 100vh;
        }

        .consultas-container {
            max-width: 1200px;
            background: #fff;
            margin: 0 auto;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .consultas-header {
            text-align: center;
            color: #2e7d32;
            font-size: 2em;
            padding: 15px;
            border-bottom: 3px solid #4caf50;
            margin-bottom: 30px;
        }

        .consultas-form {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            align-items: end;
        }

        .consultas-form div {
            display: flex;
            flex-direction: column;
        }

        .consultas-form label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #4caf50;
        }

        .consultas-form input {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
        }

        .consultas-form button {
            padding: 12px;
            background: linear-gradient(135deg, #00A859, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .consultas-form button:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 20px 40px rgba(0, 168, 89, 0.4),
                0 0 0 4px rgba(0, 168, 89, 0.1);
        }

        .consultas-form button:active {
            transform: translateY(-2px);
        }

        .consultas-form button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .consultas-form button:hover::before {
            left: 100%;
        }

        .separator {
            border-top: 3px solid #4caf50;
            margin: 40px 0 20px;
        }

        .pesquisa-global {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .pesquisa-global input {
            width: 70%;
            max-width: 600px;
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            background-color: #f1f1f1;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
            font-size: 1.1em;
            transition: 0.3s ease;
        }

        .pesquisa-global input:focus {
            background-color: #fff;
            box-shadow: 0 0 8px rgba(76,175,80,0.6);
            outline: none;
        }

        .tab-actions-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: flex-start;
            align-items: stretch;
        }

        .button-style, .consultas-tab {
            flex: 1;
            min-width: 140px;
            padding: 10px 15px;
            background: linear-gradient(135deg, #00A859, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            box-sizing: border-box;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            position: relative;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .button-style:hover, .consultas-tab:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 20px 40px rgba(0, 168, 89, 0.4),
                0 0 0 4px rgba(0, 168, 89, 0.1);
        }

        .button-style:active, .consultas-tab:active {
            transform: translateY(-2px);
        }

        .button-style::before, .consultas-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .button-style:hover::before, .consultas-tab:hover::before {
            left: 100%;
        }

        .consultas-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: flex-start;
            align-items: stretch;
        }

        .consultas-tab.active {
            background: linear-gradient(135deg, #2e7d32, #1b5e20) !important;
            color: white !important;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.4);
            transform: translateY(-2px);
            border: 2px solid #4caf50;
        }

        .consultas-tables-container {
            width: 100%;
        }

        .consultas-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background-color: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .consultas-table th,
        .consultas-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }

        .consultas-table th {
            background-color: #4caf50;
            color: white;
            font-weight: bold;
            text-transform: uppercase;
        }

        .consultas-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .consultas-table tr:hover {
            background-color: #f1f1f1;
        }

        .consultas-table button {
            padding: 8px 12px;
            margin: 0 4px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .consultas-table button.edit-btn {
            background-color: #ffc107;
        }

        .consultas-table button.edit-btn:hover {
            background-color: #e0a800;
        }

        .consultas-table button.save-btn {
            background-color: #28a745;
        }

        .consultas-table button.save-btn:hover {
            background-color: #218838;
        }

        .consultas-table button.cancel-btn {
            background-color: #dc3545;
        }

        .consultas-table button.cancel-btn:hover {
            background-color: #c82333;
        }

        .consultas-table button:hover {
            background-color: #2e7d32;
        }

        .consultas-table td.editable {
            background-color: #fff;
            border: 1px solid #4CAF50;
        }

        .consultas-table td.editable input[type="text"],
        .consultas-table td.editable input[type="date"],
        .consultas-table td.editable input[type="time"] {
            width: calc(100% - 16px);
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background-color: #333;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            opacity: 0;
            transform: translateY(-20px);
            animation: fadeInOut 4s forwards;
            min-width: 250px;
            text-align: center;
        }

        .toast.success {
            background-color: #4CAF50;
        }

        .toast.error {
            background-color: #dc3545;
        }

        .toast.info {
            background-color: #007bff;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }

        .consultas-logout-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .consultas-logout-btn:hover {
            background: linear-gradient(135deg, #c82333, #a71e2a);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }

        .consultas-logout-btn:active {
            transform: translateY(0);
        }

        .consultas-tab.dragging {
            opacity: 0.5;
            outline: 2px dashed #2e7d32;
        }

        .consultas-tab.drag-over {
            border-left: 3px solid #2e7d32 !important;
        }

        /* Modal de confirmação moderno */
        .confirm-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .confirm-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .confirm-content {
            background: white;
            border-radius: 20px;
            padding: 32px;
            max-width: 480px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: scale(0.8) translateY(20px);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-align: center;
        }

        .confirm-modal.show .confirm-content {
            transform: scale(1) translateY(0);
        }

        .confirm-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
        }

        .confirm-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 12px;
        }

        .confirm-message {
            font-size: 16px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 32px;
        }

        .confirm-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .confirm-btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .confirm-btn.danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
        }

        .confirm-btn.danger:hover {
            background: linear-gradient(135deg, #ee5a52, #dc4c64);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .confirm-btn.secondary {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #e9ecef;
        }

        .confirm-btn.secondary:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .confirm-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            margin: 16px 0;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 600;
        }

        .confirm-input:focus {
            outline: none;
            border-color: #ff6b6b;
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .confirm-input.valid {
            border-color: #28a745;
            background: #f8fff9;
        }

        .confirm-input.invalid {
            border-color: #ff6b6b;
            background: #fff8f8;
        }

        .input-hint {
            font-size: 14px;
            color: #999;
            margin-top: 8px;
            font-style: italic;
        }

        /* Modal Sobre SMC */
        .smc-info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .smc-info-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .smc-info-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
            transform: scale(0.8) translateY(30px);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .smc-info-modal.show .smc-info-content {
            transform: scale(1) translateY(0);
        }

        .smc-info-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #4caf50;
            padding-bottom: 20px;
        }

        .smc-info-title {
            font-size: 32px;
            font-weight: 800;
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .smc-info-subtitle {
            font-size: 18px;
            color: #666;
            font-weight: 500;
        }

        .smc-feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .smc-feature-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .smc-feature-card:hover {
            border-color: #4caf50;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.2);
        }

        .smc-detail-page {
            display: none;
            animation: slideInRight 0.4s ease;
        }

        .smc-detail-page.active {
            display: block;
        }

        .smc-main-content {
            display: block;
        }

        .smc-main-content.hidden {
            display: none;
        }

        .smc-back-btn {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .smc-back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        @keyframes slideInRight {
            from { transform: translateX(30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .smc-feature-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }

        .smc-feature-title {
            font-size: 18px;
            font-weight: 700;
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .smc-feature-desc {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
        }

        .smc-close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .smc-close-btn:hover {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <!-- Efeito de partículas -->
    <div id="particles-js"></div>
    
    <!-- Ícones médicos flutuantes -->
    <div class="floating-icons">
        <div class="medical-icon" style="top: 10%; left: 15%; animation-delay: 0s;">🏥</div>
        <div class="medical-icon" style="top: 20%; right: 20%; animation-delay: 1s;">🩺</div>
        <div class="medical-icon" style="bottom: 30%; left: 10%; animation-delay: 2s;">💊</div>
        <div class="medical-icon" style="bottom: 15%; right: 15%; animation-delay: 3s;">❤️</div>
        <div class="medical-icon" style="top: 60%; left: 5%; animation-delay: 4s;">🏥</div>
        <div class="medical-icon" style="top: 40%; right: 8%; animation-delay: 5s;">⚕️</div>
    </div>

    <!-- Container de login -->
    <div class="login-container" id="loginSection">
        <div class="login-card" id="loginCard">
            <div class="logo-section">
                <div class="sus-logo">
                    <svg width="54" height="54" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="13" cy="13" r="6" fill="#ffffff" stroke="#ffffff" stroke-width="2"/>
                        <circle cx="41" cy="13" r="6" fill="#ffffff" stroke="#ffffff" stroke-width="2"/>
                        <path d="M13 19 Q13 28 20 34 Q23 37 27 37" stroke="#ffffff" stroke-width="5" fill="none" stroke-linecap="round"/>
                        <path d="M41 19 Q41 28 34 34 Q31 37 27 37" stroke="#ffffff" stroke-width="5" fill="none" stroke-linecap="round"/>
                        <line x1="27" y1="37" x2="27" y2="42" stroke="#ffffff" stroke-width="5" stroke-linecap="round"/>
                        <circle cx="27" cy="46" r="7" fill="#ffffff"/>
                        <circle cx="27" cy="46" r="5" fill="#00A859"/>
                        <circle cx="27" cy="46" r="3" fill="#ffffff"/>
                    </svg>
                </div>
                <div class="system-badge">SMC - Sistema de Marcação de Consultas</div>
                <h1 class="login-title">Portal SMC</h1>
                <p class="login-subtitle">Acesse sua conta para marcar consultas, exames e acompanhar seu histórico médico</p>
            </div>

            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label" for="email">E-mail ou CPF</label>
                    <input type="text" id="email" class="form-input" placeholder="Digite seu e-mail ou CPF" required>
                    <span class="input-icon">👤</span>
                </div>

                <div class="form-group">
                    <label class="form-label" for="password">Senha</label>
                    <input type="password" id="password" class="form-input" placeholder="Digite sua senha" required>
                    <span class="input-icon">🔒</span>
                </div>

                <div class="login-options">
                    <label class="remember-me">
                        <input type="checkbox" id="remember">
                        Lembrar de mim
                    </label>
                    <a href="#" class="forgot-password" onclick="showForgotPassword()">Esqueci minha senha</a>
                </div>

                <button type="submit" class="login-button">
                    <span class="button-text">Acessar Sistema</span>
                </button>
            </form>

            <div class="footer-section">
                <p class="footer-text">
                    <strong>Admin:</strong> admin@smc.com / admin123<br>
                    Ou <a href="#" onclick="showRegister()" class="footer-link">cadastre-se aqui</a>
                </p>
                
                <div class="help-links">
                    <a href="#" class="help-link" onclick="showHelpCenter()">Central de Ajuda</a>
                    <a href="#" class="help-link" onclick="showContact()">Fale Conosco</a>
                    <a href="#" class="help-link" onclick="showSMCInfo()">Sobre o SMC</a>
                </div>
            </div>
        </div>

        <!-- Formulário de Cadastro -->
        <div class="card hidden" id="registerCard" style="max-width: 400px; padding: 38px 32px;">
            <div style="text-align: center; margin-bottom: 24px;">
                <h2 style="color: #333; margin-bottom: 8px;">Cadastrar Usuário</h2>
                <p style="color: #666; font-size: 14px;">Preencha os dados para criar uma nova conta</p>
            </div>
            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label" for="registerName">Nome Completo</label>
                    <input type="text" id="registerName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerEmail">E-mail</label>
                    <input type="email" id="registerEmail" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerCpf">CPF</label>
                    <input type="text" id="registerCpf" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerPhone">Telefone</label>
                    <input type="text" id="registerPhone" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerPassword">Senha</label>
                    <input type="password" id="registerPassword" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerRole">Função</label>
                    <select id="registerRole" class="form-select" required>
                        <option value="user">Usuário</option>
                        <option value="doctor">Médico</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <button type="submit" class="btn">Cadastrar</button>
                <button type="button" class="btn btn-secondary" onclick="showLogin()" style="margin-top: 10px; background: linear-gradient(135deg, #6c757d, #5a6268);">Voltar ao Login</button>
            </form>
        </div>
    </div>

    <!-- Painel Administrativo -->
    <div id="adminPanel">
        <div class="admin-header">
            <div>
                <h2 style="color: #333; margin-bottom: 4px;">Painel Administrativo</h2>
                <span id="welcomeUser" style="color: #666; font-size: 14px;"></span>
            </div>
            <button class="btn btn-sm" onclick="logout()" style="width: auto; padding: 10px 20px;">Sair</button>
        </div>

        <div class="tabs">
            <button class="tab-btn active" data-tab="usersTab">👥 Usuários</button>
            <button class="tab-btn" data-tab="registerTab">➕ Cadastrar</button>
            <button class="tab-btn" data-tab="profileTab">👤 Perfil</button>
            <button class="tab-btn" data-tab="systemTab">⚙️ Sistema</button>
        </div>

        <!-- Aba Usuários -->
        <div id="usersTab" class="tab-content active">
            <h3 style="margin-bottom: 20px; color: #333;">Gerenciamento de Usuários</h3>
            <table class="users-table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>E-mail</th>
                        <th>CPF</th>
                        <th>Telefone</th>
                        <th>Função</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody id="usersTableBody"></tbody>
            </table>
        </div>

        <!-- Aba Cadastrar -->
        <div id="registerTab" class="tab-content">
            <h3 style="margin-bottom: 20px; color: #333;">Cadastrar Novo Usuário</h3>
            <form id="adminRegisterForm">
                <div class="form-group">
                    <label class="form-label" for="adminRegisterName">Nome Completo</label>
                    <input type="text" id="adminRegisterName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="adminRegisterEmail">E-mail</label>
                    <input type="email" id="adminRegisterEmail" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="adminRegisterCpf">CPF</label>
                    <input type="text" id="adminRegisterCpf" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="adminRegisterPhone">Telefone</label>
                    <input type="text" id="adminRegisterPhone" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="adminRegisterPassword">Senha</label>
                    <input type="password" id="adminRegisterPassword" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="adminRegisterRole">Função</label>
                    <select id="adminRegisterRole" class="form-select" required>
                        <option value="user">Usuário</option>
                        <option value="doctor">Médico</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <button type="submit" class="btn">Cadastrar Usuário</button>
            </form>
        </div>

        <!-- Aba Perfil -->
        <div id="profileTab" class="tab-content">
            <h3 style="margin-bottom: 20px; color: #333;">Meu Perfil</h3>
            <form id="profileForm">
                <div class="form-group">
                    <label class="form-label" for="profileName">Nome Completo</label>
                    <input type="text" id="profileName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="profileEmail">E-mail</label>
                    <input type="email" id="profileEmail" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="profilePhone">Telefone</label>
                    <input type="text" id="profilePhone" class="form-input" required>
                </div>
                <button type="submit" class="btn">Atualizar Perfil</button>
            </form>
        </div>

        <!-- Aba Sistema -->
        <div id="systemTab" class="tab-content">
            <h3 style="margin-bottom: 20px; color: #333;">Configurações do Sistema</h3>
            <div class="form-group">
                <label class="form-label">Total de usuários cadastrados</label>
                <div style="padding: 24px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-radius: 16px; font-weight: 700; font-size: 28px; color: #00A859; text-align: center;" id="totalUsers">0</div>
            </div>
            <div class="form-group">
                <label class="form-label">Usuários por função</label>
                <div id="usersByRole" style="padding: 20px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-radius: 16px;"></div>
            </div>
        </div>
    </div>

    <!-- Modal para editar usuário -->
    <div id="editUserModal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px);">
        <div class="card" style="max-width: 500px; margin: 0;">
            <h3 style="margin-bottom: 20px; color: #333;">Editar Usuário</h3>
            <form id="editUserForm">
                <input type="hidden" id="editUserId">
                <div class="form-group">
                    <label class="form-label" for="editUserName">Nome</label>
                    <input type="text" id="editUserName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editUserEmail">E-mail</label>
                    <input type="email" id="editUserEmail" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editUserRole">Função</label>
                    <select id="editUserRole" class="form-select" required>
                        <option value="user">Usuário</option>
                        <option value="doctor">Médico</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button type="submit" class="btn">Salvar</button>
                    <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de escolha do admin -->
    <div id="adminChoiceModal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px);">
        <div class="login-card" style="max-width: 480px; margin: 0;">
            <div class="logo-section">
                <div class="sus-logo">
                    <svg width="54" height="54" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="13" cy="13" r="6" fill="#ffffff" stroke="#ffffff" stroke-width="2"/>
                        <circle cx="41" cy="13" r="6" fill="#ffffff" stroke="#ffffff" stroke-width="2"/>
                        <path d="M13 19 Q13 28 20 34 Q23 37 27 37" stroke="#ffffff" stroke-width="5" fill="none" stroke-linecap="round"/>
                        <path d="M41 19 Q41 28 34 34 Q31 37 27 37" stroke="#ffffff" stroke-width="5" fill="none" stroke-linecap="round"/>
                        <line x1="27" y1="37" x2="27" y2="42" stroke="#ffffff" stroke-width="5" stroke-linecap="round"/>
                        <circle cx="27" cy="46" r="7" fill="#ffffff"/>
                        <circle cx="27" cy="46" r="5" fill="#00A859"/>
                        <circle cx="27" cy="46" r="3" fill="#ffffff"/>
                    </svg>
                </div>
                <h1 class="login-title">Bem-vindo, Administrador!</h1>
                <p class="login-subtitle">Escolha onde deseja acessar o sistema</p>
            </div>

            <div style="display: flex; flex-direction: column; gap: 16px;">
                <button onclick="goToAdmin()" class="login-button" style="background: linear-gradient(135deg, #6c757d, #5a6268);">
                    ⚙️ Área Administrativa
                </button>
                <button onclick="goToProgram()" class="login-button">
                    🏥 Programa SMC
                </button>
            </div>
        </div>
    </div>

    <!-- Painel de Marcação de Consultas -->
    <div id="consultasPanel">
        <div class="consultas-container">
            <h2 class="consultas-header">
                <span style="font-size:1.3em; vertical-align:middle; margin-right:10px;">🩺</span>
                Marcação de Consultas
            </h2>
            <form id="consultasCadastroForm" class="consultas-form">
                <div style="grid-column: span 1;"><label for="consultasDataCadastro">Data Cadastro</label><input type="date" id="consultasDataCadastro" readonly></div>
                <div style="grid-column: span 1;"><label for="consultasDataExame">Data Exame</label><input type="date" id="consultasDataExame"></div>
                <div style="grid-column: span 1;"><label for="consultasHora">Hora</label><input type="time" id="consultasHora"></div>
                <div style="grid-column: span 1;"><label for="consultasLocal">Local</label><input type="text" id="consultasLocal" placeholder="Local do exame"></div>
                
                <div style="grid-column: span 2;"><label for="consultasPaciente">Paciente</label><input type="text" id="consultasPaciente" placeholder="Nome do paciente" required></div>
                <div style="grid-column: span 2;"><label for="consultasMedicoExame">Médico / Exame</label><input type="text" id="consultasMedicoExame" placeholder="Nome do médico ou tipo de exame" required></div>
                
                <div style="grid-column: span 1;"><label for="consultasAcs">ACS / Tel.</label><input type="text" id="consultasAcs" placeholder="Nome do ACS ou telefone"></div>
                <div style="grid-column: span 1;"><label for="consultasCns">CNS</label><input type="text" id="consultasCns" placeholder="Número do CNS"></div>
                <div style="grid-column: span 1;"><label for="consultasObs">OBS</label><input type="text" id="consultasObs" placeholder="Observações"></div>
                <div style="grid-column: span 1;"><button type="submit">Cadastrar</button></div>
            </form>

            <div class="separator"></div>
            <div class="pesquisa-global">
                <input type="text" id="consultasPesquisaGlobal" placeholder="🔎 Pesquisar por qualquer dado na tabela...">
            </div>
            <div id="consultasResultadoPesquisa"></div>

            <button class="consultas-logout-btn" onclick="consultasLogout()">
                ← Sair
            </button>

            <div class="tab-actions-container">
                <button type="button" class="button-style" onclick="consultasAddTab()">+ Adicionar Aba</button>
                <button type="button" class="button-style" onclick="consultasDeleteCurrentTab()">− Excluir Aba</button>
                <button type="button" class="button-style" onclick="consultasClearCurrentTab()">🗑️ Limpar Aba Atual</button>
                <button type="button" class="button-style" onclick="consultasPrintSearchResults()">🖨️ Imprimir Pesquisa</button>
                <button type="button" class="button-style" onclick="consultasExportarExcelTodasAbas()">📅 Exportar Todas as Abas</button>
                <button type="button" class="button-style" onclick="document.getElementById('consultasImportFileInput').click()">📅 Importar CSV</button>
                <input type="file" id="consultasImportFileInput" accept=".csv" style="display: none;" onchange="consultasImportarCSV(event)">
                <button type="button" class="button-style" onclick="consultasPrintAllTabs()">🖨️ Imprimir Todas as Abas</button>
            </div>

            <div class="consultas-tabs" id="consultasTabsContainer">
            </div>

            <div class="consultas-tables-container" id="consultasTablesContainer">
            </div>
        </div>
    </div>

    <div class="toast-container" id="consultasToastContainer"></div>

    <!-- Modal Esqueci Minha Senha -->
    <div class="confirm-modal" id="forgotPasswordModal">
        <div class="confirm-content" style="max-width: 500px;">
            <button class="smc-close-btn" onclick="closeForgotPassword()" style="position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">×</button>
            
            <div style="text-align: center; margin-bottom: 25px;">
                <div style="width: 80px; height: 80px; margin: 0 auto 15px; border-radius: 50%; background: linear-gradient(135deg, #ffc107, #ff8f00); display: flex; align-items: center; justify-content: center; font-size: 36px;">🔑</div>
                <h3 style="color: #333; margin-bottom: 8px; font-size: 24px;">Recuperar Senha</h3>
                <p style="color: #666; font-size: 16px;">Digite seu CPF e data de nascimento para redefinir sua senha</p>
            </div>

            <form id="forgotPasswordForm">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">CPF</label>
                    <input type="text" id="recoveryCpf" placeholder="000.000.000-00" style="width: 100%; padding: 12px 16px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; box-sizing: border-box;" required>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Data de Nascimento</label>
                    <input type="date" id="recoveryBirthDate" style="width: 100%; padding: 12px 16px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; box-sizing: border-box;" required>
                </div>
                
                <div style="display: flex; gap: 12px;">
                    <button type="button" onclick="closeForgotPassword()" style="flex: 1; padding: 12px; background: #f8f9fa; color: #666; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; font-weight: 600;">Cancelar</button>
                    <button type="submit" style="flex: 1; padding: 12px; background: linear-gradient(135deg, #ffc107, #ff8f00); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">Recuperar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Central de Ajuda -->
    <div class="smc-info-modal" id="helpCenterModal">
        <div class="smc-info-content">
            <button class="smc-close-btn" onclick="closeHelpCenter()">×</button>
            
            <div class="smc-info-header">
                <h1 class="smc-info-title">🎆 Central de Ajuda SMC</h1>
                <p class="smc-info-subtitle">Encontre respostas para as perguntas mais frequentes</p>
            </div>

            <div style="display: grid; gap: 20px;">
                <div style="background: #f8fff9; border-radius: 15px; padding: 20px; border-left: 5px solid #4caf50;">
                    <h3 style="color: #2e7d32; margin-bottom: 15px; font-size: 18px;">🔑 Como faço login no sistema?</h3>
                    <p style="margin-bottom: 10px; line-height: 1.6;"><strong>Usuário comum:</strong> Use seu e-mail ou CPF cadastrado + senha</p>
                    <p style="line-height: 1.6;"><strong>Administrador:</strong> admin@smc.com / admin123</p>
                </div>

                <div style="background: #f0f8ff; border-radius: 15px; padding: 20px; border-left: 5px solid #007bff;">
                    <h3 style="color: #0056b3; margin-bottom: 15px; font-size: 18px;">📅 Como cadastrar uma consulta?</h3>
                    <p style="line-height: 1.6;">1. Preencha o formulário na parte superior<br>2. A data de cadastro é preenchida automaticamente<br>3. Clique em "Cadastrar" para salvar</p>
                </div>

                <div style="background: #fff8f0; border-radius: 15px; padding: 20px; border-left: 5px solid #ff6b35;">
                    <h3 style="color: #d63031; margin-bottom: 15px; font-size: 18px;">✏️ Como editar uma consulta?</h3>
                    <p style="line-height: 1.6;">1. Clique no botão "Editar" na linha desejada<br>2. Os dados serão carregados no formulário<br>3. Faça as alterações e clique "Salvar Alterações"</p>
                </div>

                <div style="background: #f5f0ff; border-radius: 15px; padding: 20px; border-left: 5px solid #8b5cf6;">
                    <h3 style="color: #7c3aed; margin-bottom: 15px; font-size: 18px;">📂 Como organizar em abas?</h3>
                    <p style="line-height: 1.6;">1. Clique em "+ Adicionar Aba"<br>2. Digite um nome (ex: "Cardiologia", "Janeiro")<br>3. Duplo clique na aba para renomear<br>4. Botão direito + arrastar para reordenar</p>
                </div>

                <div style="background: #f0fff4; border-radius: 15px; padding: 20px; border-left: 5px solid #10b981;">
                    <h3 style="color: #059669; margin-bottom: 15px; font-size: 18px;">🔍 Como pesquisar consultas?</h3>
                    <p style="line-height: 1.6;">Use a barra de pesquisa global para encontrar por:<br>• Nome do paciente<br>• Nome do médico<br>• Data da consulta<br>• Qualquer informação cadastrada</p>
                </div>

                <div style="background: #fef7f0; border-radius: 15px; padding: 20px; border-left: 5px solid #f59e0b;">
                    <h3 style="color: #d97706; margin-bottom: 15px; font-size: 18px;">💾 Como fazer backup dos dados?</h3>
                    <p style="line-height: 1.6;">O backup é automático! A cada cadastro/edição um arquivo é baixado.<br>Você também pode usar "Exportar Todas as Abas" manualmente.</p>
                </div>

                <div style="background: #fff0f0; border-radius: 15px; padding: 20px; border-left: 5px solid #dc3545;">
                    <h3 style="color: #dc3545; margin-bottom: 15px; font-size: 18px;">⚠️ Esqueci minha senha</h3>
                    <p style="line-height: 1.6;">1. Clique em "Esqueci minha senha" na tela de login<br>2. Digite seu CPF e data de nascimento<br>3. Uma nova senha será gerada automaticamente</p>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                <p style="color: #666; font-size: 16px; margin-bottom: 15px;">
                    <strong>Ainda precisa de ajuda?</strong> Entre em contato com o suporte técnico.
                </p>
                <button onclick="closeHelpCenter()" style="background: linear-gradient(135deg, #00A859, #28a745, #20c997); color: white; border: none; border-radius: 25px; padding: 12px 30px; font-size: 16px; font-weight: 600; cursor: pointer;">
                    Entendi! 🚀
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Sobre SMC -->
    <div class="smc-info-modal" id="smcInfoModal">
        <div class="smc-info-content">
            <button class="smc-close-btn" onclick="closeSMCInfo()">×</button>
            
            <div class="smc-info-header">
                <h1 class="smc-info-title">🏥 SMC - Sistema de Marcação de Consultas</h1>
                <p class="smc-info-subtitle">Simplicidade, Praticidade e Segurança em um só lugar</p>
            </div>

            <div class="smc-main-content" id="smcMainContent">
                <div class="smc-feature-grid">
                    <div class="smc-feature-card" onclick="showFeatureDetail('simplicidade')">
                        <span class="smc-feature-icon">⚡</span>
                        <h3 class="smc-feature-title">Simplicidade</h3>
                        <p class="smc-feature-desc">Interface intuitiva e fácil de usar. Cadastre consultas em segundos com formulário organizado e campos claros.</p>
                    </div>

                    <div class="smc-feature-card" onclick="showFeatureDetail('praticidade')">
                        <span class="smc-feature-icon">🚀</span>
                        <h3 class="smc-feature-title">Praticidade</h3>
                        <p class="smc-feature-desc">Múltiplas abas para organizar por especialidade, pesquisa global instantânea e exportação para Excel.</p>
                    </div>

                    <div class="smc-feature-card" onclick="showFeatureDetail('seguranca')">
                        <span class="smc-feature-icon">🔒</span>
                        <h3 class="smc-feature-title">Segurança</h3>
                        <p class="smc-feature-desc">Backup automático a cada operação, confirmações avançadas e dados salvos localmente no seu navegador.</p>
                    </div>

                    <div class="smc-feature-card" onclick="showFeatureDetail('organizacao')">
                        <span class="smc-feature-icon">📅</span>
                        <h3 class="smc-feature-title">Organização</h3>
                        <p class="smc-feature-desc">Crie abas personalizadas, reordene por arrastar, e mantenha consultas organizadas por categoria ou período.</p>
                    </div>

                    <div class="smc-feature-card" onclick="showFeatureDetail('pesquisa')">
                        <span class="smc-feature-icon">🔍</span>
                        <h3 class="smc-feature-title">Pesquisa Avançada</h3>
                        <p class="smc-feature-desc">Encontre qualquer consulta instantaneamente. Pesquise por paciente, médico, data ou qualquer informação.</p>
                    </div>

                    <div class="smc-feature-card" onclick="showFeatureDetail('relatorios')">
                        <span class="smc-feature-icon">📊</span>
                        <h3 class="smc-feature-title">Relatórios</h3>
                        <p class="smc-feature-desc">Imprima consultas, exporte dados para Excel e gere relatórios completos com um clique.</p>
                    </div>
                </div>
            </div>

            <!-- Páginas Detalhadas -->
            <div class="smc-detail-page" id="simplicidadeDetail">
                <button class="smc-back-btn" onclick="backToMain()">← Voltar</button>
                <h2 style="color: #2e7d32; margin-bottom: 20px; font-size: 28px;">⚡ Simplicidade</h2>
                <div style="background: #f8fff9; border-radius: 15px; padding: 25px; border-left: 5px solid #4caf50;">
                    <h3 style="color: #2e7d32; margin-bottom: 15px;">Interface Intuitiva</h3>
                    <p style="margin-bottom: 15px; line-height: 1.6;">O SMC foi projetado pensando na facilidade de uso. Cada elemento da interface foi cuidadosamente posicionado para tornar o cadastro de consultas uma tarefa simples e rápida.</p>
                    
                    <h4 style="color: #4caf50; margin: 20px 0 10px 0;">✓ Formulário Organizado</h4>
                    <p style="margin-bottom: 15px;">Campos dispostos logicamente: dados do paciente, informações da consulta e observações, tudo em uma única tela.</p>
                    
                    <h4 style="color: #4caf50; margin: 20px 0 10px 0;">✓ Preenchimento Automático</h4>
                    <p style="margin-bottom: 15px;">A data de cadastro é preenchida automaticamente, economizando tempo e evitando erros.</p>
                    
                    <h4 style="color: #4caf50; margin: 20px 0 10px 0;">✓ Validação Inteligente</h4>
                    <p>O sistema valida os dados em tempo real, destacando campos obrigatórios e orientando o usuário.</p>
                </div>
            </div>

            <div class="smc-detail-page" id="praticidadeDetail">
                <button class="smc-back-btn" onclick="backToMain()">← Voltar</button>
                <h2 style="color: #2e7d32; margin-bottom: 20px; font-size: 28px;">🚀 Praticidade</h2>
                <div style="background: #f0f8ff; border-radius: 15px; padding: 25px; border-left: 5px solid #007bff;">
                    <h3 style="color: #0056b3; margin-bottom: 15px;">Recursos que Facilitam o Dia a Dia</h3>
                    
                    <h4 style="color: #007bff; margin: 20px 0 10px 0;">📋 Múltiplas Abas</h4>
                    <p style="margin-bottom: 15px;">Organize consultas por especialidade, período ou qualquer critério. Crie, renomeie e reordene abas conforme sua necessidade.</p>
                    
                    <h4 style="color: #007bff; margin: 20px 0 10px 0;">🔍 Pesquisa Global</h4>
                    <p style="margin-bottom: 15px;">Digite qualquer informação e encontre consultas instantaneamente em todas as abas. Pesquise por nome, médico, data ou observações.</p>
                    
                    <h4 style="color: #007bff; margin: 20px 0 10px 0;">📤 Exportação Rápida</h4>
                    <p style="margin-bottom: 15px;">Exporte dados para Excel com um clique. Gere relatórios de uma aba específica ou de todas as abas simultaneamente.</p>
                    
                    <h4 style="color: #007bff; margin: 20px 0 10px 0;">🖨️ Impressão Inteligente</h4>
                    <p>Imprima resultados de pesquisa ou relatórios completos com formatação profissional automática.</p>
                </div>
            </div>

            <div class="smc-detail-page" id="segurancaDetail">
                <button class="smc-back-btn" onclick="backToMain()">← Voltar</button>
                <h2 style="color: #2e7d32; margin-bottom: 20px; font-size: 28px;">🔒 Segurança</h2>
                <div style="background: #fff8f0; border-radius: 15px; padding: 25px; border-left: 5px solid #ff6b35;">
                    <h3 style="color: #d63031; margin-bottom: 15px;">Proteção Máxima dos Seus Dados</h3>
                    
                    <h4 style="color: #ff6b35; margin: 20px 0 10px 0;">💾 Backup Automático</h4>
                    <p style="margin-bottom: 15px;">A cada cadastro ou edição, um backup completo é gerado automaticamente. Seus dados estão sempre protegidos.</p>
                    
                    <h4 style="color: #ff6b35; margin: 20px 0 10px 0;">🛡️ Confirmações Avançadas</h4>
                    <p style="margin-bottom: 15px;">Ações críticas como excluir ou limpar abas exigem confirmação por digitação, evitando perdas acidentais.</p>
                    
                    <h4 style="color: #ff6b35; margin: 20px 0 10px 0;">🏠 Dados Locais</h4>
                    <p style="margin-bottom: 15px;">Todas as informações ficam armazenadas localmente no seu navegador, garantindo privacidade total.</p>
                    
                    <h4 style="color: #ff6b35; margin: 20px 0 10px 0;">🔐 Controle de Acesso</h4>
                    <p>Sistema de login com diferentes níveis de permissão: usuário comum e administrador.</p>
                </div>
            </div>

            <div class="smc-detail-page" id="organizacaoDetail">
                <button class="smc-back-btn" onclick="backToMain()">← Voltar</button>
                <h2 style="color: #2e7d32; margin-bottom: 20px; font-size: 28px;">📅 Organização</h2>
                <div style="background: #f5f0ff; border-radius: 15px; padding: 25px; border-left: 5px solid #8b5cf6;">
                    <h3 style="color: #7c3aed; margin-bottom: 15px;">Mantenha Tudo Organizado</h3>
                    
                    <h4 style="color: #8b5cf6; margin: 20px 0 10px 0;">📂 Abas Personalizadas</h4>
                    <p style="margin-bottom: 15px;">Crie abas com nomes específicos: "Cardiologia", "Janeiro 2024", "Urgências". Organize como preferir.</p>
                    
                    <h4 style="color: #8b5cf6; margin: 20px 0 10px 0;">🔄 Reordenação por Arrastar</h4>
                    <p style="margin-bottom: 15px;">Clique com o botão direito e arraste abas para reordená-las. Mantenha as mais usadas sempre à vista.</p>
                    
                    <h4 style="color: #8b5cf6; margin: 20px 0 10px 0;">📊 Numeração Automática</h4>
                    <p style="margin-bottom: 15px;">Cada consulta recebe um número sequencial automático para fácil referência.</p>
                    
                    <h4 style="color: #8b5cf6; margin: 20px 0 10px 0;">🏷️ Edição de Nomes</h4>
                    <p>Duplo clique em qualquer aba para renomeá-la rapidamente.</p>
                </div>
            </div>

            <div class="smc-detail-page" id="pesquisaDetail">
                <button class="smc-back-btn" onclick="backToMain()">← Voltar</button>
                <h2 style="color: #2e7d32; margin-bottom: 20px; font-size: 28px;">🔍 Pesquisa Avançada</h2>
                <div style="background: #f0fff4; border-radius: 15px; padding: 25px; border-left: 5px solid #10b981;">
                    <h3 style="color: #059669; margin-bottom: 15px;">Encontre Qualquer Informação Rapidamente</h3>
                    
                    <h4 style="color: #10b981; margin: 20px 0 10px 0;">⚡ Busca Instantânea</h4>
                    <p style="margin-bottom: 15px;">Digite qualquer termo e veja os resultados aparecerem em tempo real, sem precisar pressionar Enter.</p>
                    
                    <h4 style="color: #10b981; margin: 20px 0 10px 0;">🎯 Busca Global</h4>
                    <p style="margin-bottom: 15px;">A pesquisa vasculha todas as abas simultaneamente, mostrando em qual aba cada resultado foi encontrado.</p>
                    
                    <h4 style="color: #10b981; margin: 20px 0 10px 0;">📝 Múltiplos Campos</h4>
                    <p style="margin-bottom: 15px;">Pesquise por nome do paciente, médico, data, local, CNS, observações ou qualquer informação cadastrada.</p>
                    
                    <h4 style="color: #10b981; margin: 20px 0 10px 0;">📋 Resultados Organizados</h4>
                    <p>Os resultados são exibidos em uma tabela clara, mostrando todos os dados relevantes de cada consulta encontrada.</p>
                </div>
            </div>

            <div class="smc-detail-page" id="relatoriosDetail">
                <button class="smc-back-btn" onclick="backToMain()">← Voltar</button>
                <h2 style="color: #2e7d32; margin-bottom: 20px; font-size: 28px;">📊 Relatórios</h2>
                <div style="background: #fef7f0; border-radius: 15px; padding: 25px; border-left: 5px solid #f59e0b;">
                    <h3 style="color: #d97706; margin-bottom: 15px;">Relatórios Profissionais com Um Clique</h3>
                    
                    <h4 style="color: #f59e0b; margin: 20px 0 10px 0;">📄 Exportação Excel</h4>
                    <p style="margin-bottom: 15px;">Exporte dados em formato CSV compatível com Excel. Escolha uma aba específica ou todas as abas de uma vez.</p>
                    
                    <h4 style="color: #f59e0b; margin: 20px 0 10px 0;">🖨️ Impressão Formatada</h4>
                    <p style="margin-bottom: 15px;">Imprima relatórios com formatação profissional automática, incluindo cabeçalhos e organização por abas.</p>
                    
                    <h4 style="color: #f59e0b; margin: 20px 0 10px 0;">🔍 Relatório de Pesquisa</h4>
                    <p style="margin-bottom: 15px;">Imprima apenas os resultados de uma pesquisa específica, ideal para relatórios direcionados.</p>
                    
                    <h4 style="color: #f59e0b; margin: 20px 0 10px 0;">📊 Dados Completos</h4>
                    <p>Todos os campos são incluídos: número, datas, paciente, médico, local, ACS, CNS e observações.</p>
                </div>
            </div>

            <div style="background: linear-gradient(135deg, #e8f5e8, #f0f8f0); border-radius: 15px; padding: 25px; margin-top: 30px; text-align: center;">
                <h3 style="color: #2e7d32; margin-bottom: 15px; font-size: 20px;">🎆 Principais Funcionalidades</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; text-align: left;">
                    <div>
                        <strong style="color: #4caf50;">✓ Cadastro Rápido:</strong><br>
                        <small>Formulário inteligente com data automática</small>
                    </div>
                    <div>
                        <strong style="color: #4caf50;">✓ Edição Segura:</strong><br>
                        <small>Edite registros com confirmação avançada</small>
                    </div>
                    <div>
                        <strong style="color: #4caf50;">✓ Backup Automático:</strong><br>
                        <small>Seus dados sempre protegidos</small>
                    </div>
                    <div>
                        <strong style="color: #4caf50;">✓ Importação CSV:</strong><br>
                        <small>Importe dados de outros sistemas</small>
                    </div>
                    <div>
                        <strong style="color: #4caf50;">✓ Abas Dinâmicas:</strong><br>
                        <small>Organize por especialidade ou período</small>
                    </div>
                    <div>
                        <strong style="color: #4caf50;">✓ Interface Moderna:</strong><br>
                        <small>Design responsivo e intuitivo</small>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                <p style="color: #666; font-size: 16px; margin-bottom: 15px;">
                    <strong>SMC</strong> - Desenvolvido para facilitar o gerenciamento de consultas médicas com máxima eficiência e segurança.
                </p>
                <button onclick="closeSMCInfo()" style="background: linear-gradient(135deg, #00A859, #28a745, #20c997); color: white; border: none; border-radius: 25px; padding: 12px 30px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                    Entendi! Vamos começar 🚀
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Fale Conosco -->
    <div class="smc-info-modal" id="contactModal">
        <div class="smc-info-content">
            <button class="smc-close-btn" onclick="closeContact()">×</button>
            
            <div class="smc-info-header">
                <h1 class="smc-info-title">📞 Fale Conosco</h1>
                <p class="smc-info-subtitle">Entre em contato com nossa equipe de suporte</p>
            </div>

            <div style="display: grid; gap: 25px;">
                <div style="background: linear-gradient(135deg, #f8fff9, #e8f5e8); border-radius: 20px; padding: 30px; text-align: center; border: 2px solid #4caf50;">
                    <div style="width: 80px; height: 80px; margin: 0 auto 20px; border-radius: 50%; background: linear-gradient(135deg, #4caf50, #2e7d32); display: flex; align-items: center; justify-content: center; font-size: 36px; color: white;">📞</div>
                    <h3 style="color: #2e7d32; margin-bottom: 15px; font-size: 24px;">Suporte Técnico</h3>
                    <p style="color: #666; font-size: 16px; margin-bottom: 20px;">Nossa equipe está pronta para ajudar você!</p>
                    
                    <div style="background: white; border-radius: 15px; padding: 25px; margin-top: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        <h4 style="color: #2e7d32; margin-bottom: 15px; font-size: 18px;">📱 Contatos</h4>
                        <div style="text-align: left; line-height: 2;">
                            <p><strong>📞 Telefone:</strong> <span style="color: #666;">(00) 0000-0000</span></p>
                            <p><strong>📱 WhatsApp:</strong> <span style="color: #666;">(00) 00000-0000</span></p>
                            <p><strong>✉️ E-mail:</strong> <span style="color: #666;">suporte@smc.com</span></p>
                            <p><strong>🕰️ Horário:</strong> <span style="color: #666;">Segunda a Sexta, 8h às 18h</span></p>
                        </div>
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #f0f8ff, #e6f3ff); border-radius: 20px; padding: 25px; border: 2px solid #007bff;">
                    <h3 style="color: #0056b3; margin-bottom: 15px; font-size: 20px; text-align: center;">📝 Envie sua Mensagem</h3>
                    <form id="contactForm" style="display: grid; gap: 15px;">
                        <div>
                            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 5px;">Nome Completo</label>
                            <input type="text" id="contactName" placeholder="Digite seu nome" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; box-sizing: border-box;" required>
                        </div>
                        
                        <div>
                            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 5px;">E-mail</label>
                            <input type="email" id="contactEmail" placeholder="seu@email.com" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; box-sizing: border-box;" required>
                        </div>
                        
                        <div>
                            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 5px;">Assunto</label>
                            <select id="contactSubject" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; box-sizing: border-box;" required>
                                <option value="">Selecione o assunto</option>
                                <option value="suporte">Suporte Técnico</option>
                                <option value="duvida">Dúvida sobre o Sistema</option>
                                <option value="sugestao">Sugestão de Melhoria</option>
                                <option value="problema">Relatar Problema</option>
                                <option value="outro">Outro</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; font-weight: 600; color: #333; margin-bottom: 5px;">Mensagem</label>
                            <textarea id="contactMessage" placeholder="Descreva sua dúvida ou solicitação..." rows="4" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; resize: vertical; box-sizing: border-box;" required></textarea>
                        </div>
                        
                        <button type="submit" style="background: linear-gradient(135deg, #007bff, #0056b3); color: white; border: none; border-radius: 8px; padding: 15px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            🚀 Enviar Mensagem
                        </button>
                    </form>
                </div>
            </div>

            <div style="text-align: center; margin-top: 25px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">
                    <strong>Nota:</strong> As informações de contato serão atualizadas em breve.
                </p>
                <button onclick="closeContact()" style="background: linear-gradient(135deg, #6c757d, #5a6268); color: white; border: none; border-radius: 25px; padding: 10px 25px; font-size: 14px; font-weight: 600; cursor: pointer;">
                    Fechar
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <script>
        let users = [];
        let currentUser = null;

        document.addEventListener('DOMContentLoaded', function() {
            initParticles();
            initSystem();
            setupEventListeners();
            setupTiltEffect();
            loadRememberedCredentials();
        });

        function initParticles() {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 80, density: { enable: true, value_area: 1000 } },
                    color: { value: ['#ffffff', '#00A859', '#28a745', '#20c997'] },
                    shape: { type: ['circle', 'triangle'] },
                    opacity: { value: 0.2, random: true, anim: { enable: true, speed: 1.5, opacity_min: 0 } },
                    size: { value: 4, random: true, anim: { enable: true, speed: 3, size_min: 0.5 } },
                    line_linked: { enable: true, distance: 120, color: '#ffffff', opacity: 0.15, width: 1 },
                    move: { enable: true, speed: 1.5, direction: 'none', random: true, out_mode: 'out', attract: { enable: true, rotateX: 600, rotateY: 1200 } }
                },
                interactivity: {
                    detect_on: 'window',
                    events: { onhover: { enable: true, mode: 'grab' }, onclick: { enable: true, mode: 'push' } },
                    modes: { grab: { distance: 180, line_linked: { opacity: 0.6 } }, push: { particles_nb: 3 } }
                },
                retina_detect: true
            });
        }

        function setupTiltEffect() {
            const applyTilt = (element) => {
                element.addEventListener('mousemove', function(e) {
                    const rect = this.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = (y - centerY) / 37;
                    const rotateY = (centerX - x) / 37;
                    this.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(10px)`;
                });
                
                element.addEventListener('mouseleave', function() {
                    this.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateZ(0px)';
                });
            };
            
            // Aplica em login-card e card
            document.querySelectorAll('.card, .login-card').forEach(applyTilt);
            
            const observer = new MutationObserver(mutations => {
                mutations.forEach(mutation => {
                    mutation.addedNodes.forEach(node => {
                        if (node.nodeType === 1 && (node.classList?.contains('card') || node.classList?.contains('login-card'))) {
                            applyTilt(node);
                        }
                        if (node.nodeType === 1) {
                            node.querySelectorAll?.('.card, .login-card').forEach(applyTilt);
                        }
                    });
                });
            });
            
            observer.observe(document.body, { childList: true, subtree: true });
        }

        function initSystem() {
            const savedUsers = JSON.parse(localStorage.getItem('smc_users') || '[]');
            if (savedUsers.length === 0) {
                const defaultAdmin = {
                    id: 'admin_001',
                    name: 'Administrador do Sistema',
                    email: 'admin@smc.com',
                    cpf: '000.000.000-00',
                    phone: '(00) 00000-0000',
                    password: 'admin123',
                    role: 'admin',
                    createdAt: new Date().toISOString()
                };
                users = [defaultAdmin];
                localStorage.setItem('smc_users', JSON.stringify(users));
            } else {
                users = savedUsers;
            }

            // Sempre limpar sessão ao abrir o sistema
            localStorage.removeItem('smc_session');
            currentUser = null;
        }

        function setupEventListeners() {
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('adminRegisterForm').addEventListener('submit', handleAdminRegister);
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
            document.getElementById('editUserForm').addEventListener('submit', handleUserEdit);

            // Máscaras
            document.getElementById('registerCpf').addEventListener('input', maskCPF);
            document.getElementById('registerPhone').addEventListener('input', maskPhone);
            document.getElementById('adminRegisterCpf').addEventListener('input', maskCPF);
            document.getElementById('adminRegisterPhone').addEventListener('input', maskPhone);

            // Toggle senha
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('input-icon') && (e.target.textContent === '🔒' || e.target.textContent === '👁️')) {
                    const passwordInput = document.getElementById('password');
                    const icon = e.target;
                    
                    if (passwordInput && passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        icon.textContent = '👁️';
                    } else if (passwordInput) {
                        passwordInput.type = 'password';
                        icon.textContent = '🔒';
                    }
                }
            });
            
            // Adicionar dropdown de usuários lembrados
            setupRememberedUsersDropdown();
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            const remember = document.getElementById('remember').checked;
            const button = document.querySelector('.login-button');
            const buttonText = document.querySelector('.button-text');
            
            if (!email || !password) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }

            // Resetar estados visuais antes de começar
            document.body.classList.remove('loading', 'success');
            button.style.cursor = 'not-allowed';
            button.style.background = 'linear-gradient(135deg, #6c757d, #adb5bd)';
            buttonText.textContent = 'Verificando credenciais...';
            document.body.classList.add('loading');

            setTimeout(() => {
                const user = users.find(u => (u.email === email || u.cpf === email) && u.password === password);
                
                if (user) {
                    currentUser = user;
                    localStorage.setItem('smc_session', JSON.stringify({ userId: user.id, loginTime: new Date().toISOString() }));
                    
                    // Salvar credenciais se "lembrar de mim" estiver marcado
                    if (remember) {
                        let remembered;
                        try {
                            remembered = JSON.parse(localStorage.getItem('smc_remember') || '[]');
                            if (!Array.isArray(remembered)) remembered = [];
                        } catch (e) {
                            remembered = [];
                        }
                        
                        const existingIndex = remembered.findIndex(r => r && r.email === email);
                        
                        if (existingIndex >= 0) {
                            remembered[existingIndex] = { email, password, name: user.name };
                        } else {
                            remembered.push({ email, password, name: user.name });
                        }
                        
                        localStorage.setItem('smc_remember', JSON.stringify(remembered));
                    }
                    
                    // Sucesso
                    document.body.classList.remove('loading');
                    document.body.classList.add('success');
                    button.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
                    button.style.cursor = 'pointer';
                    buttonText.textContent = '✓ Acesso autorizado!';
                    
                    setTimeout(() => {
                        showNotification('Login realizado com sucesso!', 'success');
                        
                        // Resetar completamente antes de navegar
                        document.body.classList.remove('loading', 'success');
                        button.style.background = 'linear-gradient(135deg, #00A859, #28a745, #20c997)';
                        buttonText.textContent = 'Acessar Sistema';
                        
                        if (user.role === 'admin') {
                            showAdminChoice();
                        } else {
                            showConsultasPanel();
                        }
                    }, 1000);
                } else {
                    // Erro
                    document.body.classList.remove('loading');
                    button.style.background = 'linear-gradient(135deg, #dc3545, #c82333)';
                    button.style.cursor = 'not-allowed';
                    buttonText.textContent = 'Credenciais inválidas';
                    
                    setTimeout(() => {
                        button.style.background = 'linear-gradient(135deg, #00A859, #28a745, #20c997)';
                        button.style.cursor = 'pointer';
                        buttonText.textContent = 'Acessar Sistema';
                        document.body.classList.remove('loading', 'success');
                    }, 2000);
                    
                    showNotification('E-mail/CPF ou senha incorretos!', 'error');
                }
            }, 1500);
        }

        function handleRegister(e) {
            e.preventDefault();
            const name = document.getElementById('registerName').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const cpf = document.getElementById('registerCpf').value.trim();
            const phone = document.getElementById('registerPhone').value.trim();
            const password = document.getElementById('registerPassword').value;
            const role = document.getElementById('registerRole').value;

            if (!name || !email || !cpf || !phone || !password) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }

            if (!validateCPF(cpf)) {
                showNotification('CPF inválido!', 'error');
                return;
            }

            if (users.find(u => u.email === email || u.cpf === cpf)) {
                showNotification('E-mail ou CPF já cadastrado!', 'error');
                return;
            }

            const newUser = {
                id: 'user_' + Date.now(),
                name, email, cpf, phone, password, role,
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('smc_users', JSON.stringify(users));
            showNotification('Usuário cadastrado com sucesso!', 'success');
            document.getElementById('registerForm').reset();
            setTimeout(() => showLogin(), 1500);
        }

        function handleAdminRegister(e) {
            e.preventDefault();
            const name = document.getElementById('adminRegisterName').value.trim();
            const email = document.getElementById('adminRegisterEmail').value.trim();
            const cpf = document.getElementById('adminRegisterCpf').value.trim();
            const phone = document.getElementById('adminRegisterPhone').value.trim();
            const password = document.getElementById('adminRegisterPassword').value;
            const role = document.getElementById('adminRegisterRole').value;

            if (!name || !email || !cpf || !phone || !password) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }

            if (!validateCPF(cpf)) {
                showNotification('CPF inválido!', 'error');
                return;
            }

            if (users.find(u => u.email === email || u.cpf === cpf)) {
                showNotification('E-mail ou CPF já cadastrado!', 'error');
                return;
            }

            const newUser = {
                id: 'user_' + Date.now(),
                name, email, cpf, phone, password, role,
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('smc_users', JSON.stringify(users));
            showNotification('Usuário cadastrado com sucesso!', 'success');
            document.getElementById('adminRegisterForm').reset();
            updateUsersTable();
            updateSystemStats();
        }

        function handleProfileUpdate(e) {
            e.preventDefault();
            const name = document.getElementById('profileName').value.trim();
            const email = document.getElementById('profileEmail').value.trim();
            const phone = document.getElementById('profilePhone').value.trim();

            if (!name || !email || !phone) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }

            currentUser.name = name;
            currentUser.email = email;
            currentUser.phone = phone;

            const userIndex = users.findIndex(u => u.id === currentUser.id);
            users[userIndex] = currentUser;
            localStorage.setItem('smc_users', JSON.stringify(users));
            
            showNotification('Perfil atualizado com sucesso!', 'success');
            document.getElementById('welcomeUser').textContent = `Olá, ${currentUser.name}`;
        }

        function handleUserEdit(e) {
            e.preventDefault();
            const userId = document.getElementById('editUserId').value;
            const name = document.getElementById('editUserName').value.trim();
            const email = document.getElementById('editUserEmail').value.trim();
            const role = document.getElementById('editUserRole').value;

            if (!name || !email) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }

            const userIndex = users.findIndex(u => u.id === userId);
            if (userIndex !== -1) {
                users[userIndex].name = name;
                users[userIndex].email = email;
                users[userIndex].role = role;
                
                localStorage.setItem('smc_users', JSON.stringify(users));
                showNotification('Usuário atualizado com sucesso!', 'success');
                closeEditModal();
                updateUsersTable();
                updateSystemStats();
            }
        }

        function maskCPF(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = value;
        }

        function maskPhone(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d{5})(\d)/, '$1-$2');
            e.target.value = value;
        }

        function validateCPF(cpf) {
            cpf = cpf.replace(/[^\d]/g, '');
            if (cpf.length !== 11 || /^(\d)\1{10}$/.test(cpf)) return false;
            
            let sum = 0;
            for (let i = 0; i < 9; i++) sum += parseInt(cpf[i]) * (10 - i);
            let digit1 = 11 - (sum % 11);
            if (digit1 > 9) digit1 = 0;
            
            sum = 0;
            for (let i = 0; i < 10; i++) sum += parseInt(cpf[i]) * (11 - i);
            let digit2 = 11 - (sum % 11);
            if (digit2 > 9) digit2 = 0;
            
            return cpf[9] == digit1 && cpf[10] == digit2;
        }

        function showAdminPanel() {
            // Verificar se o usuário tem privilégios de admin
            if (!currentUser || currentUser.role !== 'admin') {
                showNotification('Acesso negado! Apenas administradores podem acessar esta área.', 'error');
                showConsultasPanel();
                return;
            }
            
            const loginSection = document.getElementById('loginSection');
            const adminPanel = document.getElementById('adminPanel');
            const welcomeUser = document.getElementById('welcomeUser');
            
            if (loginSection) loginSection.style.display = 'none';
            if (adminPanel) adminPanel.style.display = 'block';
            if (welcomeUser) welcomeUser.textContent = `Olá, ${currentUser.name}`;
            
            loadUserProfile();
            updateUsersTable();
            updateSystemStats();
            setupTabs();
        }

        function loadUserProfile() {
            document.getElementById('profileName').value = currentUser.name;
            document.getElementById('profileEmail').value = currentUser.email;
            document.getElementById('profilePhone').value = currentUser.phone;
        }

        function updateUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.cpf}</td>
                    <td>${user.phone}</td>
                    <td>${getRoleName(user.role)}</td>
                    <td>
                        <button onclick="editUser('${user.id}')" class="btn btn-sm">Editar</button>
                        <button onclick="deleteUser('${user.id}')" class="btn btn-sm btn-danger">Excluir</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateSystemStats() {
            document.getElementById('totalUsers').textContent = users.length;
            
            const roleCount = users.reduce((acc, user) => {
                acc[user.role] = (acc[user.role] || 0) + 1;
                return acc;
            }, {});
            
            const roleDiv = document.getElementById('usersByRole');
            roleDiv.innerHTML = Object.entries(roleCount)
                .map(([role, count]) => `<div style="padding: 8px 0; border-bottom: 1px solid #eee;"><strong>${getRoleName(role)}:</strong> ${count}</div>`)
                .join('');
        }

        function getRoleName(role) {
            const roles = {
                'admin': 'Administrador',
                'doctor': 'Médico',
                'user': 'Usuário'
            };
            return roles[role] || role;
        }

        function setupTabs() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabId = btn.dataset.tab;
                    
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    btn.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        function editUser(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                document.getElementById('editUserId').value = user.id;
                document.getElementById('editUserName').value = user.name;
                document.getElementById('editUserEmail').value = user.email;
                document.getElementById('editUserRole').value = user.role;
                document.getElementById('editUserModal').classList.remove('hidden');
            }
        }

        function deleteUser(userId) {
            if (confirm('Tem certeza que deseja excluir este usuário?')) {
                users = users.filter(u => u.id !== userId);
                localStorage.setItem('smc_users', JSON.stringify(users));
                updateUsersTable();
                updateSystemStats();
                showNotification('Usuário excluído com sucesso!', 'success');
            }
        }

        function closeEditModal() {
            document.getElementById('editUserModal').classList.add('hidden');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 16px 24px;
                border-radius: 12px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                background: ${type === 'success' ? 'linear-gradient(135deg, #28a745, #20c997)' : 'linear-gradient(135deg, #dc3545, #c82333)'};
                box-shadow: 0 8px 25px ${type === 'success' ? 'rgba(40, 167, 69, 0.3)' : 'rgba(220, 53, 69, 0.3)'};
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        function logout() {
            localStorage.removeItem('smc_session');
            currentUser = null;
            
            const adminPanel = document.getElementById('adminPanel');
            const consultasPanel = document.getElementById('consultasPanel');
            const loginSection = document.getElementById('loginSection');
            const loginCard = document.getElementById('loginCard');
            const registerCard = document.getElementById('registerCard');
            
            if (adminPanel) adminPanel.style.display = 'none';
            if (consultasPanel) consultasPanel.style.display = 'none';
            if (loginSection) {
                loginSection.style.display = 'flex';
                loginSection.style.justifyContent = 'center';
                loginSection.style.alignItems = 'center';
                document.body.style.overflow = 'hidden';
            }
            
            // Garantir que apenas o login card está visível
            if (loginCard) loginCard.classList.remove('hidden');
            if (registerCard) registerCard.classList.add('hidden');
            
            // Limpar formulário de login mas manter credenciais se lembradas
            const loginForm = document.getElementById('loginForm');
            if (loginForm) loginForm.reset();
            loadRememberedCredentials();
            
            // Resetar estados visuais
            document.body.classList.remove('loading', 'success');
            const button = document.querySelector('.login-button');
            const buttonText = document.querySelector('.button-text');
            if (button) {
                button.style.background = 'linear-gradient(135deg, #00A859, #28a745, #20c997)';
                button.style.cursor = 'pointer';
            }
            if (buttonText) buttonText.textContent = 'Acessar Sistema';
            
            showNotification('Logout realizado com sucesso!', 'success');
        }

        function showRegister() {
            document.getElementById('loginCard').classList.add('hidden');
            document.getElementById('registerCard').classList.remove('hidden');
        }

        function showLogin() {
            document.getElementById('registerCard').classList.add('hidden');
            document.getElementById('loginCard').classList.remove('hidden');
            
            // Limpar formulário completamente
            const loginForm = document.getElementById('loginForm');
            if (loginForm) loginForm.reset();
            
            // Garantir campos limpos
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
            document.getElementById('remember').checked = false;
            
            // Resetar estados visuais
            document.body.classList.remove('loading', 'success');
            const button = document.querySelector('.login-button');
            const buttonText = document.querySelector('.button-text');
            if (button) {
                button.style.background = 'linear-gradient(135deg, #00A859, #28a745, #20c997)';
                button.style.cursor = 'pointer';
            }
            if (buttonText) buttonText.textContent = 'Acessar Sistema';
        }

        function loadRememberedCredentials() {
            // Não preencher automaticamente - deixar campos limpos
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
            document.getElementById('remember').checked = false;
        }
        
        function setupRememberedUsersDropdown() {
            const emailInput = document.getElementById('email');
            let remembered;
            try {
                remembered = JSON.parse(localStorage.getItem('smc_remember') || '[]');
                if (!Array.isArray(remembered)) remembered = [];
            } catch (e) {
                remembered = [];
            }
            
            if (remembered.length > 1) {
                // Criar dropdown apenas se houver múltiplos usuários
                const dropdown = Object.assign(document.createElement('div'), {
                    className: 'remembered-users-dropdown',
                    style: 'position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #e8ecef; border-top: none; border-radius: 0 0 16px 16px; max-height: 200px; overflow-y: auto; z-index: 1000; display: none;'
                });
                
                remembered.forEach(user => {
                    if (user && user.email && user.password && user.name) {
                        const option = Object.assign(document.createElement('div'), {
                            className: 'dropdown-option',
                            style: 'padding: 12px 16px; cursor: pointer; border-bottom: 1px solid #f0f0f0; transition: background 0.2s ease;',
                            innerHTML: `<strong>${user.name}</strong><br><small style="color: #666;">${user.email}</small>`
                        });
                        
                        option.addEventListener('click', () => {
                            document.getElementById('email').value = user.email;
                            document.getElementById('password').value = user.password;
                            document.getElementById('remember').checked = true;
                            dropdown.style.display = 'none';
                        });
                        
                        option.addEventListener('mouseenter', () => option.style.background = '#f8f9fa');
                        option.addEventListener('mouseleave', () => option.style.background = 'white');
                        
                        dropdown.appendChild(option);
                    }
                });
                
                // Posicionar dropdown
                const emailGroup = emailInput.parentNode;
                emailGroup.style.position = 'relative';
                emailGroup.appendChild(dropdown);
                
                // Mostrar/esconder dropdown
                emailInput.addEventListener('focus', () => {
                    if (remembered.length > 1) dropdown.style.display = 'block';
                });
                
                document.addEventListener('click', (e) => {
                    if (!emailGroup.contains(e.target)) {
                        dropdown.style.display = 'none';
                    }
                });
            }
            
            // Preencher senha automaticamente ao digitar email
            emailInput.addEventListener('input', () => {
                const currentEmail = emailInput.value.trim();
                if (currentEmail && remembered.length > 0) {
                    const matchedUser = remembered.find(user => user && user.email === currentEmail);
                    if (matchedUser && matchedUser.password) {
                        document.getElementById('password').value = matchedUser.password;
                        document.getElementById('remember').checked = true;
                    }
                }
            });
        }

        // Sistema de Marcação de Consultas
        let consultasCurrentTab = 0;
        let consultasAllTableData = [];

        function initConsultasSystem() {
            const dataCadastroInput = document.getElementById('consultasDataCadastro');
            dataCadastroInput.value = new Date().toISOString().split('T')[0];
            
            // Verificar se já foi inicializado para evitar duplicação
            const tabsContainer = document.getElementById('consultasTabsContainer');
            const tablesContainer = document.getElementById('consultasTablesContainer');
            
            if (tabsContainer.children.length === 0 && tablesContainer.children.length === 0) {
                consultasCarregarLocalStorage();
                consultasSetupEventListeners();
            }
        }

        function consultasSetupEventListeners() {
            const form = document.getElementById('consultasCadastroForm');
            const search = document.getElementById('consultasPesquisaGlobal');
            
            // Remover listeners existentes se houver
            form.removeEventListener('submit', consultasHandleSubmit);
            search.removeEventListener('input', consultasPesquisaGlobal);
            
            // Adicionar novos listeners
            form.addEventListener('submit', consultasHandleSubmit);
            search.addEventListener('input', consultasPesquisaGlobal);
            consultasSetupTabDragAndDrop();
        }

        function consultasHandleSubmit(e) {
            e.preventDefault();
            const table = document.querySelectorAll('.consultas-table')[consultasCurrentTab];
            const formData = [
                document.getElementById('consultasDataCadastro').value,
                document.getElementById('consultasMedicoExame').value,
                document.getElementById('consultasPaciente').value,
                document.getElementById('consultasDataExame').value,
                document.getElementById('consultasHora').value,
                document.getElementById('consultasLocal').value,
                document.getElementById('consultasAcs').value,
                document.getElementById('consultasCns').value,
                document.getElementById('consultasObs').value
            ];

            if (consultasEditingRowIndex !== null) {
                // Modo edição - atualizar linha existente
                const row = table.rows[consultasEditingRowIndex + 1]; // +1 porque o header é row 0
                const cells = [...row.cells];
                
                cells[1].textContent = consultasFormatDate(formData[0], true);
                cells[2].textContent = formData[2]; // paciente
                cells[3].textContent = formData[1]; // medicoExame
                cells[4].textContent = consultasFormatDate(formData[3], true);
                cells[5].textContent = formData[4];
                cells[6].textContent = formData[5];
                cells[7].textContent = formData[6];
                cells[8].textContent = formData[7];
                cells[9].textContent = formData[8];
                
                // Resetar variáveis de edição
                consultasEditingRowIndex = null;
                consultasOriginalData = null;
                
                // Voltar ao modo cadastro
                consultasToggleFormEditMode(false);
                
                // Limpar formulário
                e.target.reset();
                document.getElementById('consultasDataCadastro').value = new Date().toISOString().split('T')[0];
                
                consultasShowToast('Cadastro atualizado com sucesso!', 'success');
            } else {
                // Modo cadastro - adicionar nova linha
                consultasAdicionarLinhaTabela(table, ...formData);
                consultasReindexTable(table);
                
                // Limpar formulário
                e.target.reset();
                document.getElementById('consultasDataCadastro').value = new Date().toISOString().split('T')[0];
                
                consultasShowToast('Cadastro adicionado com sucesso!', 'success');
            }

            consultasSalvarLocalStorage();
            
            // Backup automático após cada operação
            setTimeout(() => consultasBackupAutomatico(), 500);
        }

        function consultasAdicionarLinhaTabela(table, dataCadastro, medicoExame, paciente, dataExame, hora, local, acs, cns, obs) {
            const row = table.insertRow();
            row.insertCell(0); // N°
            row.insertCell(1).textContent = consultasFormatDate(dataCadastro, true);
            row.insertCell(2).textContent = paciente;
            row.insertCell(3).textContent = medicoExame;
            row.insertCell(4).textContent = consultasFormatDate(dataExame, true);
            row.insertCell(5).textContent = hora;
            row.insertCell(6).textContent = local;
            row.insertCell(7).textContent = acs;
            row.insertCell(8).textContent = cns;
            row.insertCell(9).textContent = obs;

            const actions = row.insertCell(10);
            actions.innerHTML = `<button class="edit-btn" onclick="consultasEditarCadastro(this)">Editar</button> <button onclick="consultasExcluirCadastro(this)">Excluir</button>`;
        }

        function consultasFormatDate(dateString, toDisplay = true) {
            if (!dateString) return '';
            const parts = dateString.split(/[-\/]/);
            if (parts.length !== 3) return dateString;

            if (dateString.includes('/')) {
                return toDisplay ? dateString : `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`;
            } else {
                return toDisplay ? `${parts[2].padStart(2, '0')}/${parts[1].padStart(2, '0')}/${parts[0]}` : dateString;
            }
        }

        function consultasReindexTable(table) {
            for (let i = 1; i < table.rows.length; i++) {
                table.rows[i].cells[0].textContent = i;
            }
        }

        function consultasAddTab() {
            const nomesAbas = [...document.querySelectorAll('.consultas-tab')].map(tab => tab.textContent);
            const newTabName = prompt('Digite o nome da nova aba:', `Aba ${nomesAbas.length + 1}`);
            
            if (newTabName === null) return; // Cancelou
            
            const nomeFinal = newTabName.trim() || `Aba ${nomesAbas.length + 1}`;
            
            if (nomesAbas.includes(nomeFinal)) {
                consultasShowToast('Já existe uma aba com esse nome!', 'error');
                return;
            }
            
            const index = document.querySelectorAll('.consultas-tab').length;
            const tab = Object.assign(document.createElement('div'), {
                className: 'consultas-tab',
                textContent: nomeFinal,
                onclick: () => consultasSwitchTab(index),
                ondblclick: () => consultasEditTab(tab)
            });
            document.getElementById('consultasTabsContainer').appendChild(tab);

            const table = Object.assign(document.createElement('table'), {
                className: 'consultas-table',
                innerHTML: `<tr><th>N°</th><th>Data Cadastro</th><th>Paciente</th><th>Médico/Exame</th><th>Data</th><th>Hora</th><th>Local</th><th>ACS / Tel.</th><th>CNS</th><th>OBS</th><th>Ações</th></tr>`
            });
            document.getElementById('consultasTablesContainer').appendChild(table);

            consultasSwitchTab(index);
            consultasShowToast(`Aba "${nomeFinal}" adicionada!`, 'success');
            consultasSalvarLocalStorage();
        }

        function consultasEditTab(tab) {
            const novoNome = prompt('Novo nome da aba:', tab.textContent);
            if (novoNome?.trim()) {
                const nomesAbas = [...document.querySelectorAll('.consultas-tab')].map(t => t.textContent);
                if (nomesAbas.includes(novoNome.trim()) && novoNome.trim() !== tab.textContent) {
                    consultasShowToast('Já existe uma aba com esse nome!', 'error');
                    return;
                }
                tab.textContent = novoNome.trim();
                consultasSalvarLocalStorage();
                consultasShowToast(`Aba renomeada para "${tab.textContent}".`, 'success');
            } else if (novoNome !== null) {
                consultasShowToast('O nome da aba não pode ser vazio.', 'error');
            }
        }

        function consultasSwitchTab(index) {
            consultasCurrentTab = index;
            document.querySelectorAll('.consultas-tab').forEach((t, i) => t.classList.toggle('active', i === index));
            document.querySelectorAll('.consultas-table').forEach((t, i) => t.style.display = i === index ? '' : 'none');
        }

        function consultasDeleteCurrentTab() {
            const tabs = document.querySelectorAll('.consultas-tab');
            if (tabs.length === 1) {
                consultasShowToast('Não é possível excluir a última aba.', 'error');
                return;
            }

            if (confirm('Tem certeza que deseja excluir esta aba?')) {
                document.querySelectorAll('.consultas-table')[consultasCurrentTab].remove();
                tabs[consultasCurrentTab].remove();
                consultasCurrentTab = Math.max(0, consultasCurrentTab - 1);
                consultasSwitchTab(consultasCurrentTab);
                consultasSalvarLocalStorage();
            }
        }

        function consultasClearCurrentTab() {
            const table = document.querySelectorAll('.consultas-table')[consultasCurrentTab];
            if (confirm('Tem certeza que deseja limpar todos os dados desta aba?')) {
                while (table.rows.length > 1) table.deleteRow(1);
                consultasReindexTable(table);
                consultasSalvarLocalStorage();
                consultasShowToast('Dados da aba foram limpos.', 'success');
            }
        }

        let consultasEditingRowIndex = null;
        let consultasOriginalData = null;

        function consultasEditarCadastro(btn) {
            // Verificar se já existe uma edição em andamento
            if (consultasEditingRowIndex !== null) {
                consultasShowToast('Já existe uma edição em andamento. Finalize ou cancele antes de editar outro registro.', 'error');
                return;
            }
            
            const row = btn.parentNode.parentNode;
            const cells = [...row.cells];
            consultasEditingRowIndex = row.rowIndex - 1; // -1 porque o header é row 0
            
            // Salvar dados originais
            consultasOriginalData = {
                dataCadastro: consultasFormatDate(cells[1].textContent, false),
                paciente: cells[2].textContent,
                medicoExame: cells[3].textContent,
                dataExame: consultasFormatDate(cells[4].textContent, false),
                hora: cells[5].textContent,
                local: cells[6].textContent,
                acs: cells[7].textContent,
                cns: cells[8].textContent,
                obs: cells[9].textContent
            };
            
            // Carregar dados no formulário
            document.getElementById('consultasDataCadastro').value = consultasOriginalData.dataCadastro;
            document.getElementById('consultasPaciente').value = consultasOriginalData.paciente;
            document.getElementById('consultasMedicoExame').value = consultasOriginalData.medicoExame;
            document.getElementById('consultasDataExame').value = consultasOriginalData.dataExame;
            document.getElementById('consultasHora').value = consultasOriginalData.hora;
            document.getElementById('consultasLocal').value = consultasOriginalData.local;
            document.getElementById('consultasAcs').value = consultasOriginalData.acs;
            document.getElementById('consultasCns').value = consultasOriginalData.cns;
            document.getElementById('consultasObs').value = consultasOriginalData.obs;
            
            // Alterar botões do formulário
            consultasToggleFormEditMode(true);
            
            // Scroll para o formulário e focar no campo paciente
            document.getElementById('consultasCadastroForm').scrollIntoView({ behavior: 'smooth' });
            
            setTimeout(() => {
                document.getElementById('consultasPaciente').focus();
            }, 500);
            
            consultasShowToast('Dados carregados no formulário para edição', 'info');
        }

        function consultasToggleFormEditMode(isEditing) {
            const form = document.getElementById('consultasCadastroForm');
            const submitBtnContainer = form.querySelector('div:last-child');
            let submitBtn = form.querySelector('button[type="submit"]');
            
            if (isEditing) {
                // Modo edição: substituir botão por container com 2 botões
                submitBtn.style.display = 'none';
                
                const editContainer = Object.assign(document.createElement('div'), {
                    className: 'consultas-edit-mode',
                    style: 'display: flex; gap: 10px;'
                });
                
                const saveBtn = Object.assign(document.createElement('button'), {
                    type: 'submit',
                    textContent: 'Salvar Alterações',
                    style: 'padding: 12px; background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; border-radius: 16px; cursor: pointer; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; flex: 1;'
                });
                
                const cancelBtn = Object.assign(document.createElement('button'), {
                    type: 'button',
                    textContent: 'Cancelar',
                    onclick: consultasCancelarEdicaoForm,
                    style: 'padding: 12px; background: linear-gradient(135deg, #dc3545, #c82333); color: white; border: none; border-radius: 16px; cursor: pointer; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; flex: 1;'
                });
                
                editContainer.appendChild(saveBtn);
                editContainer.appendChild(cancelBtn);
                submitBtnContainer.appendChild(editContainer);
            } else {
                // Modo cadastro: remover container de edição e mostrar botão original
                const editContainer = form.querySelector('.consultas-edit-mode');
                if (editContainer) {
                    editContainer.remove();
                }
                
                // Restaurar botão original
                submitBtn.style.display = 'block';
                submitBtn.textContent = 'Cadastrar';
                submitBtn.style.background = 'linear-gradient(135deg, #00A859, #28a745, #20c997)';
            }
        }

        function consultasCancelarEdicaoForm() {
            // Limpar formulário
            document.getElementById('consultasCadastroForm').reset();
            document.getElementById('consultasDataCadastro').value = new Date().toISOString().split('T')[0];
            
            // Resetar modo de edição
            consultasToggleFormEditMode(false);
            consultasEditingRowIndex = null;
            consultasOriginalData = null;
            
            consultasShowToast('Edição cancelada', 'info');
        }

        function consultasExcluirCadastro(btn) {
            if (confirm('Deseja excluir este cadastro?')) {
                const table = btn.parentNode.parentNode.parentNode;
                btn.parentNode.parentNode.remove();
                consultasReindexTable(table);
                consultasSalvarLocalStorage();
                consultasShowToast('Cadastro excluído.', 'success');
            }
        }

        function consultasPesquisaGlobal() {
            const search = document.getElementById('consultasPesquisaGlobal').value.toLowerCase().trim();
            const resultadoDiv = document.getElementById('consultasResultadoPesquisa');
            resultadoDiv.innerHTML = '';

            if (!search) return;

            consultasCaptureAllTableData();
            const resultTable = Object.assign(document.createElement('table'), {
                className: 'consultas-table',
                innerHTML: `<tr><th>Aba</th><th>N°</th><th>Data Cadastro</th><th>Paciente</th><th>Médico/Exame</th><th>Data</th><th>Hora</th><th>Local</th><th>ACS / Tel.</th><th>CNS</th><th>OBS</th></tr>`
            });
            let foundResults = false;

            consultasAllTableData.forEach(rowData => {
                const searchableFields = [
                    rowData.id, rowData.dataCadastro, rowData.paciente, rowData.medicoExame,
                    rowData.dataExame, rowData.hora, rowData.local, rowData.acs, rowData.cns, rowData.obs
                ];
                const searchableText = searchableFields.join(' ').toLowerCase();

                if (searchableText.includes(search)) {
                    const newRow = resultTable.insertRow();
                    newRow.insertCell(0).textContent = rowData.tabName;
                    newRow.insertCell(1).textContent = rowData.id;
                    newRow.insertCell(2).textContent = rowData.dataCadastro;
                    newRow.insertCell(3).textContent = rowData.paciente;
                    newRow.insertCell(4).textContent = rowData.medicoExame;
                    newRow.insertCell(5).textContent = rowData.dataExame;
                    newRow.insertCell(6).textContent = rowData.hora;
                    newRow.insertCell(7).textContent = rowData.local;
                    newRow.insertCell(8).textContent = rowData.acs;
                    newRow.insertCell(9).textContent = rowData.cns;
                    newRow.insertCell(10).textContent = rowData.obs;
                    foundResults = true;
                }
            });

            resultadoDiv.appendChild(foundResults ? resultTable : Object.assign(document.createElement('p'), {
                style: "text-align: center; color: #666; margin-top: 20px;",
                textContent: "Nenhum resultado encontrado."
            }));
        }

        function consultasCaptureAllTableData() {
            consultasAllTableData = [];
            document.querySelectorAll('.consultas-table').forEach((table, tabIndex) => {
                const tabElement = document.querySelectorAll('.consultas-tab')[tabIndex];
                const tabName = tabElement ? tabElement.textContent : `Aba ${tabIndex + 1}`;
                
                [...table.rows].slice(1).forEach((row, rowIndex) => {
                    const cells = [...row.cells];
                    consultasAllTableData.push({
                        tabIndex, tabName, rowIndex,
                        id: cells[0].textContent,
                        dataCadastro: cells[1].textContent,
                        paciente: cells[2].textContent,
                        medicoExame: cells[3].textContent,
                        dataExame: cells[4].textContent,
                        hora: cells[5].textContent,
                        local: cells[6].textContent,
                        acs: cells[7].textContent,
                        cns: cells[8].textContent,
                        obs: cells[9].textContent
                    });
                });
            });
        }

        function consultasPrintSearchResults() {
            const resultTable = document.querySelector('#consultasResultadoPesquisa table');
            if (!resultTable || resultTable.rows.length <= 1) {
                consultasShowToast('Nenhum resultado de pesquisa para imprimir!', 'info');
                return;
            }

            let printContent = `
                <html>
                <head>
                    <title>Relatório de Pesquisa de Consultas</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .print-header { text-align: center; color: #2e7d32; margin-bottom: 25px; font-size: 1.8em; }
                        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        th, td { border: 1px solid #000; padding: 6px; text-align: left; font-size: 0.7em; }
                        th { background-color: #eee !important; color: #000 !important; font-weight: bold; }
                    </style>
                </head>
                <body>
                    <h1 class="print-header">Resultados da Pesquisa de Consultas</h1>
                    <table>
            `;

            const headerRow = resultTable.rows[0];
            printContent += `<thead><tr>`;
            for (let i = 0; i < headerRow.cells.length; i++) {
                printContent += `<th>${headerRow.cells[i].textContent}</th>`;
            }
            printContent += `</tr></thead><tbody>`;

            for (let i = 1; i < resultTable.rows.length; i++) {
                const row = resultTable.rows[i];
                printContent += `<tr>`;
                for (let j = 0; j < row.cells.length; j++) {
                    printContent += `<td>${row.cells[j].textContent}</td>`;
                }
                printContent += `</tr>`;
            }
            printContent += `</tbody></table></body></html>`;

            const printWindow = window.open('', '_blank', 'width=900,height=700');
            if (!printWindow) {
                consultasShowToast('A janela de impressão foi bloqueada pelo navegador.', 'error');
                return;
            }

            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.onload = function() { printWindow.print(); };
            consultasShowToast('Gerando visualização para impressão...', 'info');
        }

        function consultasExportarExcelTodasAbas() {
            const allTables = [...document.querySelectorAll('.consultas-table')];
            if (allTables.every(table => table.rows.length <= 1)) {
                consultasShowToast('Não há dados em nenhuma aba para exportar!', 'info');
                return;
            }
            
            let csvContent = '';
            const firstHeaderRow = document.querySelector('.consultas-table tr');
            if (firstHeaderRow) {
                const globalHeader = [
                    "N°", "Data Cadastro", "Paciente", "Médico/Exame", "Data", "Hora", "Local", "ACS / Tel.", "CNS", "OBS"
                ].map(cell => `"${cell.replace(/"/g, '""')}"`).join(';');
                csvContent += globalHeader + '\n';
            }

            allTables.forEach((table, tabIndex) => {
                if (table.rows.length <= 1) return;
                const tabName = document.querySelectorAll('.consultas-tab')[tabIndex]?.textContent || `Aba ${tabIndex + 1}`;
                csvContent += `\n"--- Dados da Aba: ${tabName} ---"\n`;

                [...table.rows].slice(1).forEach(row => {
                    const cells = [...row.cells];
                    const rowData = [
                        cells[0].textContent, // N°
                        consultasFormatDate(cells[1].textContent, false), // Data Cadastro
                        cells[2].textContent, // Paciente
                        cells[3].textContent, // Médico/Exame
                        consultasFormatDate(cells[4].textContent, false), // Data
                        cells[5].textContent, // Hora
                        cells[6].textContent, // Local
                        cells[7].textContent, // ACS
                        cells[8].textContent, // CNS
                        cells[9].textContent  // OBS
                    ].map(cell => `"${cell.replace(/"/g, '""')}"`).join(';');
                    csvContent += rowData + '\n';
                });
            });

            const blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'});
            const link = Object.assign(document.createElement('a'), {
                href: URL.createObjectURL(blob),
                download: `consultas_completas_${consultasGetDateTimeStringForFilename()}.csv`
            });
            link.click();
            consultasShowToast('Todas as abas exportadas com sucesso!', 'success');
        }

        function consultasGetDateTimeStringForFilename() {
            const now = new Date();
            const pad = (num) => num.toString().padStart(2, '0');
            return `${now.getFullYear()}${pad(now.getMonth() + 1)}${pad(now.getDate())}_${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;
        }

        function consultasBackupAutomatico() {
            const allTables = [...document.querySelectorAll('.consultas-table')];
            if (allTables.every(table => table.rows.length <= 1)) return;
            
            let csvContent = '';
            const firstHeaderRow = document.querySelector('.consultas-table tr');
            if (firstHeaderRow) {
                const globalHeader = [
                    "N°", "Data Cadastro", "Paciente", "Médico/Exame", "Data", "Hora", "Local", "ACS / Tel.", "CNS", "OBS"
                ].map(cell => `"${cell.replace(/"/g, '""')}"`).join(';');
                csvContent += globalHeader + '\n';
            }

            allTables.forEach((table, tabIndex) => {
                if (table.rows.length <= 1) return;
                const tabName = document.querySelectorAll('.consultas-tab')[tabIndex]?.textContent || `Aba ${tabIndex + 1}`;
                csvContent += `\n"--- Dados da Aba: ${tabName} ---"\n`;

                [...table.rows].slice(1).forEach(row => {
                    const cells = [...row.cells];
                    const rowData = [
                        cells[0].textContent,
                        consultasFormatDate(cells[1].textContent, false),
                        cells[2].textContent,
                        cells[3].textContent,
                        consultasFormatDate(cells[4].textContent, false),
                        cells[5].textContent,
                        cells[6].textContent,
                        cells[7].textContent,
                        cells[8].textContent,
                        cells[9].textContent
                    ].map(cell => `"${cell.replace(/"/g, '""')}"`).join(';');
                    csvContent += rowData + '\n';
                });
            });

            const blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'});
            const link = Object.assign(document.createElement('a'), {
                href: URL.createObjectURL(blob),
                download: `backup_automatico_${consultasGetDateTimeStringForFilename()}.csv`,
                style: 'display: none;'
            });
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        }

        function consultasImportarCSV(event) {
            const file = event.target.files[0];
            if (!file) {
                consultasShowToast('Nenhum arquivo selecionado.', 'info');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const lines = e.target.result.split('\n').filter(line => line.trim() !== '');

                if (lines.length <= 1) {
                    consultasShowToast('O arquivo CSV está vazio ou contém apenas o cabeçalho.', 'error');
                    return;
                }

                const isMultiTabCSV = lines.some(line => line.includes('"--- Dados da Aba:'));

                if (isMultiTabCSV) {
                    const confirmText = 'SUBSTITUIR TUDO';
                    const modal = Object.assign(document.createElement('div'), {
                        className: 'confirm-modal',
                        innerHTML: `
                            <div class="confirm-content">
                                <div class="confirm-icon">📁</div>
                                <h3 class="confirm-title">Importar Todas as Abas</h3>
                                <p class="confirm-message">
                                    <strong>ATENÇÃO:</strong> Esta ação irá <strong>SUBSTITUIR TODAS</strong> as abas existentes!<br><br>
                                    Para confirmar, digite exatamente:
                                </p>
                                <input type="text" class="confirm-input" placeholder="Digite: ${confirmText}" id="confirmInput">
                                <div class="input-hint">Digite exatamente: <strong>${confirmText}</strong></div>
                                <div class="confirm-buttons">
                                    <button class="confirm-btn secondary" onclick="this.closest('.confirm-modal').remove()">Cancelar</button>
                                    <button class="confirm-btn danger" id="confirmImport" disabled>Substituir Tudo</button>
                                </div>
                            </div>
                        `
                    });
                    
                    document.body.appendChild(modal);
                    setTimeout(() => modal.classList.add('show'), 10);
                    
                    const input = modal.querySelector('#confirmInput');
                    const confirmBtn = modal.querySelector('#confirmImport');
                    
                    input.addEventListener('input', () => {
                        const isValid = input.value === confirmText;
                        input.className = `confirm-input ${isValid ? 'valid' : 'invalid'}`;
                        confirmBtn.disabled = !isValid;
                        confirmBtn.style.opacity = isValid ? '1' : '0.5';
                    });
                    
                    confirmBtn.onclick = () => {
                        if (input.value === confirmText) {
                            modal.remove();
                            proceedWithMultiTabImport();
                        }
                    };
                    
                    modal.onclick = (e) => {
                        if (e.target === modal) {
                            modal.remove();
                            event.target.value = '';
                        }
                    };
                    
                    setTimeout(() => input.focus(), 300);
                    
                    function proceedWithMultiTabImport() {

                        // Limpa tudo
                        document.querySelectorAll('.consultas-tab').forEach(el => el.remove());
                        document.querySelectorAll('.consultas-table').forEach(el => el.remove());
                        consultasCurrentTab = 0;

                        let currentImportTable = null;
                        let linesProcessed = 0;
                        let startIndex = lines[0].includes('Data Cadastro') ? 1 : 0;

                        for (let i = startIndex; i < lines.length; i++) {
                            const line = lines[i].trim();
                            if (!line) continue;
                            const tabMatch = line.match(/"--- Dados da Aba: (.+) ---"/);

                            if (tabMatch) {
                                const tabName = tabMatch[1];
                                consultasAddTabWithName(tabName, false);
                                currentImportTable = document.querySelectorAll('.consultas-table')[document.querySelectorAll('.consultas-table').length - 1];
                            } else if (currentImportTable && line) {
                                const values = consultasParseCSVLine(line);
                                if (values.length >= 9) {
                                    const dataForTable = [
                                        values[1], // dataCadastro
                                        values[3], // medicoExame
                                        values[2], // paciente
                                        values[4], // dataExame
                                        values[5], // hora
                                        values[6], // local
                                        values[7], // acs
                                        values[8], // cns
                                        values[9] || ''  // obs
                                    ];
                                    consultasAdicionarLinhaTabela(currentImportTable, ...dataForTable);
                                    linesProcessed++;
                                }
                            }
                        }

                        document.querySelectorAll('.consultas-table').forEach(consultasReindexTable);
                        if (document.querySelectorAll('.consultas-tab').length > 0) {
                            consultasSwitchTab(0);
                        } else {
                            consultasAddTabWithName('Aba 1', true);
                        }
                        consultasSalvarLocalStorage();
                        consultasShowToast(`Importação concluída! ${linesProcessed} registros importados.`, 'success');
                    }
                } else {
                    // CSV de aba única - mostrar opções
                    const table = document.querySelectorAll('.consultas-table')[consultasCurrentTab];
                    const tabName = document.querySelectorAll('.consultas-tab')[consultasCurrentTab].textContent;
                    
                    const modal = Object.assign(document.createElement('div'), {
                        className: 'confirm-modal',
                        innerHTML: `
                            <div class="confirm-content">
                                <div class="confirm-icon">📄</div>
                                <h3 class="confirm-title">Importar para Aba Atual</h3>
                                <p class="confirm-message">
                                    Como deseja importar os dados para a aba "<strong>${tabName}</strong>"?
                                </p>
                                <div class="confirm-buttons" style="flex-direction: column; gap: 8px;">
                                    <button class="confirm-btn" id="addData" style="background: linear-gradient(135deg, #28a745, #20c997);">Adicionar aos Dados Existentes</button>
                                    <button class="confirm-btn danger" id="replaceData">Substituir Todos os Dados</button>
                                    <button class="confirm-btn secondary" onclick="this.closest('.confirm-modal').remove()">Cancelar</button>
                                </div>
                            </div>
                        `
                    });
                    
                    document.body.appendChild(modal);
                    setTimeout(() => modal.classList.add('show'), 10);
                    
                    modal.querySelector('#addData').onclick = () => {
                        modal.remove();
                        proceedWithSingleTabImport(false);
                    };
                    
                    modal.querySelector('#replaceData').onclick = () => {
                        modal.remove();
                        proceedWithSingleTabImport(true);
                    };
                    
                    modal.onclick = (e) => {
                        if (e.target === modal) {
                            modal.remove();
                            event.target.value = '';
                        }
                    };
                    
                    function proceedWithSingleTabImport(shouldReplace) {
                        if (shouldReplace) {
                            while (table.rows.length > 1) table.deleteRow(1);
                        }
                        
                        let linesProcessed = 0;
                        for (let i = 1; i < lines.length; i++) {
                            const line = lines[i].trim();
                            const values = consultasParseCSVLine(line);
                            if (values.length >= 9) {
                                const dataForTable = [
                                    values[0], // dataCadastro
                                    values[2], // medicoExame
                                    values[1], // paciente
                                    values[3], // dataExame
                                    values[4], // hora
                                    values[5], // local
                                    values[6], // acs
                                    values[7], // cns
                                    values[8] || ''  // obs
                                ];
                                consultasAdicionarLinhaTabela(table, ...dataForTable);
                                linesProcessed++;
                            }
                        }
                        consultasReindexTable(table);
                        consultasSalvarLocalStorage();
                        consultasShowToast(`Importação concluída! ${linesProcessed} registros importados.`, 'success');
                    }
                }
            };
            reader.readAsText(file, 'UTF-8');
            event.target.value = '';
        }

        function consultasParseCSVLine(line, delimiter = ';') {
            const fields = [];
            let currentField = "";
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];

                if (char === '"') {
                    if (inQuotes && i + 1 < line.length && line[i + 1] === '"') {
                        currentField += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === delimiter && !inQuotes) {
                    fields.push(currentField.trim());
                    currentField = "";
                } else {
                    currentField += char;
                }
            }
            fields.push(currentField.trim());
            return fields;
        }

        function consultasPrintAllTabs() {
            const allTables = document.querySelectorAll('.consultas-table');
            const tabNames = [...document.querySelectorAll('.consultas-tab')].map(tab => tab.textContent);

            const hasData = [...allTables].some(table => table.rows.length > 1);
            if (!hasData) {
                consultasShowToast('Não há dados em nenhuma aba para imprimir!', 'info');
                return;
            }

            let printContent = `
                <html>
                <head>
                    <title>Relatório de Consultas - Todas as Abas</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .print-header { text-align: center; color: #2e7d32; margin-bottom: 25px; font-size: 1.8em; }
                        .print-tab-title { font-size: 1.1em; font-weight: bold; margin-top: 25px; margin-bottom: 8px; text-align: center; border-bottom: 1px solid #ccc; padding-bottom: 3px; }
                        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        th, td { border: 1px solid #000; padding: 6px; text-align: left; font-size: 0.7em; }
                        th { background-color: #eee !important; color: #000 !important; font-weight: bold; }
                    </style>
                </head>
                <body>
                    <h1 class="print-header">Relatório de Consultas - Todas as Abas</h1>
            `;

            allTables.forEach((table, tabIndex) => {
                if (table.rows.length <= 1) return;
                const tabName = tabNames[tabIndex] || `Aba ${tabIndex + 1}`;
                printContent += `<div class="print-tab-title">Dados da ${tabName}</div><table>`;

                const headerRow = table.rows[0];
                printContent += `<thead><tr>`;
                for (let i = 0; i < headerRow.cells.length - 1; i++) {
                    printContent += `<th>${headerRow.cells[i].textContent}</th>`;
                }
                printContent += `</tr></thead><tbody>`;

                for (let i = 1; i < table.rows.length; i++) {
                    const row = table.rows[i];
                    printContent += `<tr>`;
                    for (let j = 0; j < row.cells.length - 1; j++) {
                        printContent += `<td>${row.cells[j].textContent}</td>`;
                    }
                    printContent += `</tr>`;
                }
                printContent += `</tbody></table>`;
            });

            printContent += `</body></html>`;

            const printWindow = window.open('', '_blank', 'width=900,height=700');
            if (!printWindow) {
                consultasShowToast('A janela de impressão foi bloqueada pelo navegador.', 'error');
                return;
            }

            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.onload = function() { printWindow.print(); };
            consultasShowToast('Gerando visualização para impressão de todas as abas...', 'info');
        }

        function consultasLogout() {
            // Limpar sessão do usuário
            localStorage.removeItem('smc_session');
            currentUser = null;
            
            const consultasPanel = document.getElementById('consultasPanel');
            const loginSection = document.getElementById('loginSection');
            const loginCard = document.getElementById('loginCard');
            const registerCard = document.getElementById('registerCard');
            
            if (consultasPanel) consultasPanel.style.display = 'none';
            if (loginSection) {
                loginSection.style.display = 'flex';
                loginSection.style.justifyContent = 'center';
                loginSection.style.alignItems = 'center';
                document.body.style.overflow = 'hidden';
            }
            
            // Garantir que apenas o login card está visível
            if (loginCard) loginCard.classList.remove('hidden');
            if (registerCard) registerCard.classList.add('hidden');
            
            // Limpar formulário completamente
            const loginForm = document.getElementById('loginForm');
            if (loginForm) loginForm.reset();
            
            // Garantir campos limpos
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
            document.getElementById('remember').checked = false;
            
            // Resetar estados visuais
            document.body.classList.remove('loading', 'success');
            const button = document.querySelector('.login-button');
            const buttonText = document.querySelector('.button-text');
            if (button) {
                button.style.background = 'linear-gradient(135deg, #00A859, #28a745, #20c997)';
                button.style.cursor = 'pointer';
            }
            if (buttonText) buttonText.textContent = 'Acessar Sistema';
            
            consultasShowToast('Sessão encerrada. Voltando ao login...', 'info');
        }

        function consultasSalvarLocalStorage() {
            try {
                const dadosTabelas = [...document.querySelectorAll('.consultas-table')].map(table =>
                    [...table.rows].slice(1).map(row => {
                        const cells = [...row.cells];
                        return [
                            consultasFormatDate(cells[1].textContent, false),
                            cells[3].textContent,
                            cells[2].textContent,
                            consultasFormatDate(cells[4].textContent, false),
                            cells[5].textContent,
                            cells[6].textContent,
                            cells[7].textContent,
                            cells[8].textContent,
                            cells[9].textContent
                        ];
                    })
                );
                const nomesAbas = [...document.querySelectorAll('.consultas-tab')].map(tab => tab.textContent);
                localStorage.setItem('consultas_data', JSON.stringify(dadosTabelas));
                localStorage.setItem('consultas_tabs', JSON.stringify(nomesAbas));
                localStorage.setItem('consultas_active_tab', consultasCurrentTab.toString());
            } catch (e) {
                console.error('Erro ao salvar dados:', e);
            }
        }

        function consultasCarregarLocalStorage() {
            try {
                const dadosTabelas = JSON.parse(localStorage.getItem('consultas_data')) || [];
                const nomesAbas = JSON.parse(localStorage.getItem('consultas_tabs')) || [];
                const lastActiveTab = parseInt(localStorage.getItem('consultas_active_tab')) || 0;

                if (dadosTabelas.length > 0) {
                    dadosTabelas.forEach((tableData, index) => {
                        const tabName = nomesAbas[index] || `Aba ${index + 1}`;
                        consultasAddTabWithName(tabName, false);
                        const table = document.querySelectorAll('.consultas-table')[index];
                        tableData.forEach(rowData => consultasAdicionarLinhaTabela(table, ...rowData));
                        consultasReindexTable(table);
                    });
                    consultasSwitchTab(Math.min(lastActiveTab, document.querySelectorAll('.consultas-tab').length - 1));
                } else {
                    consultasAddTabWithName('Aba 1', true);
                }
            } catch (e) {
                console.error('Erro ao carregar dados:', e);
                consultasAddTabWithName('Aba 1', true);
            }
        }

        // Variáveis para drag and drop das abas - Refatorado
        let draggingTab = null;
        let dragStartIndex = null;
        let tabClone = null;
        let tabsContainer, tablesContainer, toastContainer;

        function consultasAddTabWithName(name, activate) {
            if (!tabsContainer || !tablesContainer) {
                tabsContainer = document.getElementById('consultasTabsContainer');
                tablesContainer = document.getElementById('consultasTablesContainer');
            }
            
            const index = tabsContainer.children.length;
            const tab = Object.assign(document.createElement('div'), {
                className: 'consultas-tab',
                textContent: name,
                onclick: () => consultasSwitchTab(index),
                ondblclick: () => consultasEditTab(tab)
            });
            tabsContainer.appendChild(tab);

            const table = Object.assign(document.createElement('table'), {
                className: 'consultas-table',
                innerHTML: `<tr><th>N°</th><th>Data Cadastro</th><th>Paciente</th><th>Médico/Exame</th><th>Data</th><th>Hora</th><th>Local</th><th>ACS / Tel.</th><th>CNS</th><th>OBS</th><th>Ações</th></tr>`
            });
            tablesContainer.appendChild(table);

            if (activate) consultasSwitchTab(index);
        }

        function consultasSetupTabDragAndDrop() {
            tabsContainer = document.getElementById('consultasTabsContainer');
            if (!tabsContainer) return;
            
            tabsContainer.addEventListener('mousedown', function(e) {
                if (e.target.classList.contains('consultas-tab') && e.button === 2) {
                    draggingTab = e.target;
                    dragStartIndex = Array.from(tabsContainer.children).indexOf(draggingTab);
                    draggingTab.classList.add('dragging');
                    document.body.style.cursor = 'grabbing';

                    tabClone = draggingTab.cloneNode(true);
                    tabClone.style.cssText = `
                        position: fixed; pointer-events: none; z-index: 9999; opacity: 0.8;
                        background: #4caf50; color: #fff; border-radius: 10px; padding: 10px 15px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.2); font-weight: bold;
                        border: 2px dashed #2e7d32; transition: none;
                        width: ${draggingTab.offsetWidth}px; height: ${draggingTab.offsetHeight}px;
                        left: ${e.clientX - draggingTab.offsetWidth / 2}px;
                        top: ${e.clientY - draggingTab.offsetHeight / 2}px;
                    `;
                    document.body.appendChild(tabClone);
                    e.preventDefault();
                }
            });

            document.addEventListener('mousemove', function(e) {
                if (draggingTab && tabClone) {
                    tabClone.style.left = (e.clientX - tabClone.offsetWidth / 2) + 'px';
                    tabClone.style.top = (e.clientY - tabClone.offsetHeight / 2) + 'px';

                    const tabs = Array.from(tabsContainer.children);
                    tabs.forEach(tab => {
                        tab.classList.remove('drag-over');
                        tab.style.borderLeft = '';
                    });
                    
                    const overTab = tabs.find(tab => {
                        const rect = tab.getBoundingClientRect();
                        return e.clientY > rect.top && e.clientY < rect.bottom && e.clientX > rect.left && e.clientX < rect.right;
                    });
                    
                    if (overTab && overTab !== draggingTab) {
                        overTab.style.borderLeft = '3px solid #2e7d32';
                        overTab.classList.add('drag-over');
                    }
                }
            });

            document.addEventListener('mouseup', function(e) {
                if (draggingTab && e.button === 2) {
                    const tabs = Array.from(tabsContainer.children);
                    const overTab = tabs.find(tab => tab.classList.contains('drag-over'));
                    
                    if (overTab && overTab !== draggingTab) {
                        const targetIndex = tabs.indexOf(overTab);
                        const tables = Array.from(tablesContainer.children);

                        tabsContainer.insertBefore(draggingTab, (dragStartIndex < targetIndex) ? overTab.nextSibling : overTab);
                        tablesContainer.insertBefore(tables[dragStartIndex], (dragStartIndex < targetIndex) ? tables[targetIndex].nextSibling : tables[targetIndex]);

                        Array.from(tabsContainer.children).forEach((tab, i) => {
                            tab.onclick = () => consultasSwitchTab(i);
                        });

                        consultasSalvarLocalStorage();
                        consultasShowToast('Aba reordenada com sucesso!', 'success');
                    }
                    
                    if (tabClone) {
                        tabClone.remove();
                        tabClone = null;
                    }
                    
                    tabs.forEach(tab => {
                        tab.classList.remove('drag-over');
                        tab.style.borderLeft = '';
                    });
                    
                    if (draggingTab) draggingTab.classList.remove('dragging');
                    draggingTab = null;
                    dragStartIndex = null;
                    document.body.style.cursor = '';
                }
            });

            tabsContainer.addEventListener('contextmenu', e => {
                if (e.target.classList.contains('consultas-tab')) e.preventDefault();
            });
        }

        function consultasSwitchTab(index) {
            consultasCurrentTab = index;
            document.querySelectorAll('.consultas-tab').forEach((t, i) => {
                t.classList.toggle('active', i === index);
            });
            document.querySelectorAll('.consultas-table').forEach((t, i) => {
                t.style.display = i === index ? '' : 'none';
            });
        }

        function showConfirmModal(title, message, onConfirm) {
            const modal = Object.assign(document.createElement('div'), {
                className: 'confirm-modal',
                innerHTML: `
                    <div class="confirm-content">
                        <div class="confirm-icon">⚠️</div>
                        <h3 class="confirm-title">${title}</h3>
                        <p class="confirm-message">${message}</p>
                        <div class="confirm-buttons">
                            <button class="confirm-btn secondary" onclick="this.closest('.confirm-modal').remove()">Cancelar</button>
                            <button class="confirm-btn danger" id="confirmAction">Confirmar</button>
                        </div>
                    </div>
                `
            });
            
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('show'), 10);
            
            modal.querySelector('#confirmAction').onclick = () => {
                modal.remove();
                onConfirm();
            };
            
            modal.onclick = (e) => {
                if (e.target === modal) modal.remove();
            };
        }

        function consultasDeleteCurrentTab() {
            const tabs = document.querySelectorAll('.consultas-tab');
            if (tabs.length === 1) {
                consultasShowToast('Não é possível excluir a última aba.', 'error');
                return;
            }

            const tabName = tabs[consultasCurrentTab].textContent;
            const modal = Object.assign(document.createElement('div'), {
                className: 'confirm-modal',
                innerHTML: `
                    <div class="confirm-content">
                        <div class="confirm-icon">⚠️</div>
                        <h3 class="confirm-title">Excluir Aba</h3>
                        <p class="confirm-message">
                            Para excluir permanentemente a aba "<strong>${tabName}</strong>" e todos os seus dados,<br>
                            digite o nome da aba exatamente como aparece:
                        </p>
                        <input type="text" class="confirm-input" placeholder="Digite: ${tabName}" id="tabNameInput">
                        <div class="input-hint">Digite exatamente: <strong>${tabName}</strong></div>
                        <div class="confirm-buttons">
                            <button class="confirm-btn secondary" onclick="this.closest('.confirm-modal').remove()">Cancelar</button>
                            <button class="confirm-btn danger" id="confirmDelete" disabled>Excluir Aba</button>
                        </div>
                    </div>
                `
            });
            
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('show'), 10);
            
            const input = modal.querySelector('#tabNameInput');
            const confirmBtn = modal.querySelector('#confirmDelete');
            
            input.addEventListener('input', () => {
                const isValid = input.value === tabName;
                input.className = `confirm-input ${isValid ? 'valid' : 'invalid'}`;
                confirmBtn.disabled = !isValid;
                confirmBtn.style.opacity = isValid ? '1' : '0.5';
            });
            
            confirmBtn.onclick = () => {
                if (input.value === tabName) {
                    modal.remove();
                    document.querySelectorAll('.consultas-table')[consultasCurrentTab].remove();
                    tabs[consultasCurrentTab].remove();
                    consultasCurrentTab = Math.max(0, consultasCurrentTab - 1);
                    consultasSwitchTab(consultasCurrentTab);
                    consultasSalvarLocalStorage();
                    consultasShowToast(`Aba "${tabName}" excluída com sucesso.`, 'success');
                }
            };
            
            modal.onclick = (e) => {
                if (e.target === modal) modal.remove();
            };
            
            // Focar no input
            setTimeout(() => input.focus(), 300);
        }

        function consultasClearCurrentTab() {
            const table = document.querySelectorAll('.consultas-table')[consultasCurrentTab];
            const tabName = document.querySelectorAll('.consultas-tab')[consultasCurrentTab].textContent;
            const recordCount = table.rows.length - 1;
            
            if (recordCount === 0) {
                consultasShowToast('A aba já está vazia.', 'info');
                return;
            }

            const modal = Object.assign(document.createElement('div'), {
                className: 'confirm-modal',
                innerHTML: `
                    <div class="confirm-content">
                        <div class="confirm-icon">🗑️</div>
                        <h3 class="confirm-title">Limpar Aba</h3>
                        <p class="confirm-message">
                            Para apagar todos os <strong>${recordCount} registros</strong> da aba "<strong>${tabName}</strong>",<br>
                            digite o nome da aba exatamente como aparece:
                        </p>
                        <input type="text" class="confirm-input" placeholder="Digite: ${tabName}" id="tabNameInput">
                        <div class="input-hint">Digite exatamente: <strong>${tabName}</strong></div>
                        <div class="confirm-buttons">
                            <button class="confirm-btn secondary" onclick="this.closest('.confirm-modal').remove()">Cancelar</button>
                            <button class="confirm-btn danger" id="confirmClear" disabled>Limpar Aba</button>
                        </div>
                    </div>
                `
            });
            
            document.body.appendChild(modal);
            setTimeout(() => modal.classList.add('show'), 10);
            
            const input = modal.querySelector('#tabNameInput');
            const confirmBtn = modal.querySelector('#confirmClear');
            
            input.addEventListener('input', () => {
                const isValid = input.value === tabName;
                input.className = `confirm-input ${isValid ? 'valid' : 'invalid'}`;
                confirmBtn.disabled = !isValid;
                confirmBtn.style.opacity = isValid ? '1' : '0.5';
            });
            
            confirmBtn.onclick = () => {
                if (input.value === tabName) {
                    modal.remove();
                    while (table.rows.length > 1) table.deleteRow(1);
                    consultasReindexTable(table);
                    consultasSalvarLocalStorage();
                    consultasShowToast(`Todos os registros da aba "${tabName}" foram removidos.`, 'success');
                }
            };
            
            modal.onclick = (e) => {
                if (e.target === modal) modal.remove();
            };
            
            // Focar no input
            setTimeout(() => input.focus(), 300);
        }

        function consultasShowToast(message, type = 'info') {
            if (!toastContainer) toastContainer = document.getElementById('consultasToastContainer');
            if (!toastContainer) return;
            
            const toast = Object.assign(document.createElement('div'), {
                className: `toast ${type}`,
                textContent: message
            });
            toastContainer.appendChild(toast);
            toast.addEventListener('animationend', () => toast.remove());
        }

        function showAdminChoice() {
            const modal = document.getElementById('adminChoiceModal');
            if (modal) modal.classList.remove('hidden');
        }

        function goToAdmin() {
            const modal = document.getElementById('adminChoiceModal');
            if (modal) modal.classList.add('hidden');
            showAdminPanel();
        }

        function goToProgram() {
            const modal = document.getElementById('adminChoiceModal');
            if (modal) modal.classList.add('hidden');
            showConsultasPanel();
        }

        function showConsultasPanel() {
            const elements = {
                login: document.getElementById('loginSection'),
                admin: document.getElementById('adminPanel'),
                consultas: document.getElementById('consultasPanel')
            };
            
            if (elements.login) elements.login.style.display = 'none';
            if (elements.admin) elements.admin.style.display = 'none';
            if (elements.consultas) {
                elements.consultas.style.display = 'block';
                document.body.style.overflow = 'auto';
            }
            
            initConsultasSystem();
        }

        function showSMCInfo() {
            const modal = document.getElementById('smcInfoModal');
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeSMCInfo() {
            const modal = document.getElementById('smcInfoModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        }

        function showFeatureDetail(feature) {
            document.getElementById('smcMainContent').classList.add('hidden');
            document.getElementById(feature + 'Detail').classList.add('active');
        }

        function backToMain() {
            document.querySelectorAll('.smc-detail-page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById('smcMainContent').classList.remove('hidden');
        }

        function showForgotPassword() {
            const modal = document.getElementById('forgotPasswordModal');
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                
                // Adicionar máscara ao CPF
                const cpfInput = document.getElementById('recoveryCpf');
                cpfInput.addEventListener('input', maskCPF);
                
                // Adicionar evento ao formulário
                document.getElementById('forgotPasswordForm').addEventListener('submit', handlePasswordRecovery);
            }
        }

        function closeForgotPassword() {
            const modal = document.getElementById('forgotPasswordModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
                document.getElementById('forgotPasswordForm').reset();
            }
        }

        function handlePasswordRecovery(e) {
            e.preventDefault();
            const cpf = document.getElementById('recoveryCpf').value.trim();
            const birthDate = document.getElementById('recoveryBirthDate').value;
            
            if (!cpf || !birthDate) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }
            
            if (!validateCPF(cpf)) {
                showNotification('CPF inválido!', 'error');
                return;
            }
            
            // Simular verificação (em sistema real, verificaria no banco de dados)
            const user = users.find(u => u.cpf === cpf);
            
            if (user) {
                // Gerar nova senha temporária
                const newPassword = 'temp' + Math.random().toString(36).substr(2, 6);
                user.password = newPassword;
                
                // Salvar no localStorage
                localStorage.setItem('smc_users', JSON.stringify(users));
                
                // Mostrar nova senha
                const successModal = Object.assign(document.createElement('div'), {
                    className: 'confirm-modal show',
                    innerHTML: `
                        <div class="confirm-content" style="text-align: center;">
                            <div style="width: 80px; height: 80px; margin: 0 auto 15px; border-radius: 50%; background: linear-gradient(135deg, #28a745, #20c997); display: flex; align-items: center; justify-content: center; font-size: 36px; color: white;">✓</div>
                            <h3 style="color: #28a745; margin-bottom: 15px;">Senha Redefinida!</h3>
                            <p style="margin-bottom: 20px;">Sua nova senha temporária é:</p>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 18px; font-weight: bold; color: #333; margin-bottom: 20px;">${newPassword}</div>
                            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">Anote esta senha e altere-a após fazer login.</p>
                            <button onclick="this.closest('.confirm-modal').remove(); closeForgotPassword();" style="background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; border-radius: 8px; padding: 12px 24px; cursor: pointer; font-weight: 600;">Entendi</button>
                        </div>
                    `
                });
                
                document.body.appendChild(successModal);
                
            } else {
                showNotification('CPF não encontrado no sistema!', 'error');
            }
        }

        function showHelpCenter() {
            const modal = document.getElementById('helpCenterModal');
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeHelpCenter() {
            const modal = document.getElementById('helpCenterModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        }

        function showContact() {
            const modal = document.getElementById('contactModal');
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                
                // Adicionar evento ao formulário
                document.getElementById('contactForm').addEventListener('submit', handleContactForm);
            }
        }

        function closeContact() {
            const modal = document.getElementById('contactModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
                document.getElementById('contactForm').reset();
            }
        }

        function handleContactForm(e) {
            e.preventDefault();
            const name = document.getElementById('contactName').value.trim();
            const email = document.getElementById('contactEmail').value.trim();
            const subject = document.getElementById('contactSubject').value;
            const message = document.getElementById('contactMessage').value.trim();
            
            if (!name || !email || !subject || !message) {
                showNotification('Preencha todos os campos!', 'error');
                return;
            }
            
            // Simular envio da mensagem
            const successModal = Object.assign(document.createElement('div'), {
                className: 'confirm-modal show',
                innerHTML: `
                    <div class="confirm-content" style="text-align: center;">
                        <div style="width: 80px; height: 80px; margin: 0 auto 15px; border-radius: 50%; background: linear-gradient(135deg, #28a745, #20c997); display: flex; align-items: center; justify-content: center; font-size: 36px; color: white;">✓</div>
                        <h3 style="color: #28a745; margin-bottom: 15px;">Mensagem Enviada!</h3>
                        <p style="margin-bottom: 20px;">Sua mensagem foi recebida com sucesso.</p>
                        <p style="color: #666; font-size: 14px; margin-bottom: 20px;">Nossa equipe entrará em contato em breve através do e-mail: <strong>${email}</strong></p>
                        <button onclick="this.closest('.confirm-modal').remove(); closeContact();" style="background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; border-radius: 8px; padding: 12px 24px; cursor: pointer; font-weight: 600;">Entendi</button>
                    </div>
                `
            });
            
            document.body.appendChild(successModal);
        }
    </script>
</body>
</html>